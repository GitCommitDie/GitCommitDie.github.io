<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=0.75" /> <meta name="description" content="An advanced search utility for reddit." /> <meta property="og:title" content="Coddit ReSearch" /> <meta property="og:type" content="website" /> <meta property="og:image" content="https://github.coddit.xyz/search/static/5eYcQ.png" /> <meta property="og:url" content="https://github.coddit.xyz/search/" /> <meta property="og:description" content="An advanced search utility for reddit." /> <meta property="og:site_name" content="Coddit GitHub" /> <link rel="shortcut icon" href="/search/static/favicon.ico" type="image/x-icon" /> <title>Coddit ReSearch</title> <link rel="stylesheet" href="/search/resources/style.css" /> <style></style> </head> <body> <header> <h1> <a href="/search/" ><img src="/search/static/LCUt7.png" alt="reddit logo" /> Coddit <em style="font-weight: 300">Re</em>Search</a > </h1> <h2>Powered by <a href="https://pushshift.io" target="_blank">Pushshift</a></h2> <nav> <ul> <li><a href="/search/" class="current">Home</a></li> <li><a href="/search/about">About</a></li> <li><a href="/search/settings">Settings</a></li> </ul> </nav> <div id="parameters-panel" class="panel"> <h1 class="panel-header">Search Options<button class="panel-collapse">Expand</button></h1> <form action="/search/" id="request-form"> <fieldset> <div class="form-field parameter-q"> <label for="parameter-q">Search Terms</label> <input type="search" name="q[]" id="parameter-q" placeholder="Search Terms" spellcheck="false" autocomplete="off" data-dependent-on="parameter-meta_api=pushshift" title="Search terms" /> </div> <div class="form-field"> <label for="parameter-subreddit">Subreddit(s)</label> <input type="text" name="subreddit[]" id="parameter-subreddit" placeholder="Subreddit(s)" spellcheck="false" pattern="^[!a-zA-Z0-9_.-]{2,32}([\s,+]+[!a-zA-Z0-9_.-]{2,32})*$" title="Limit to items posted in subreddit(s) (e.g. ama,wallstreetbets)" /> </div> <div class="form-field"> <label for="parameter-author">Author(s)</label> <input type="text" name="author[]" id="parameter-author" placeholder="Author(s)" spellcheck="false" pattern="^[!a-zA-Z0-9_.-]{2,32}([\s,+]+[!a-zA-Z0-9_.-]{2,32})*$" title="Limit to items posted by author(s) (e.g. spez,automoderator)" /> </div> <div class="form-field"> <label for="parameter-before">Before</label> <input type="datetime-local" name="before" id="parameter-before" placeholder="dd/mm/yyyy --:--" title="Limit to items posted before (e.g. 02/08/2021 10:30)" /> </div> <div class="form-field"> <label for="parameter-after">After</label> <input type="datetime-local" name="after" id="parameter-after" placeholder="dd/mm/yyyy --:--" title="Limit to items posted after (e.g. 02/08/2021 10:30)" /> </div> <div class="form-field advanced-option"> <label for="parameter-score">Score Threshold</label> <input type="text" name="score" id="parameter-score" class="small" placeholder="Score Threshold" spellcheck="false" pattern="[&gt;&lt;]=?-?\d+" title="Limit to items with scores matching threshold (e.g. >200)" /> </div> </fieldset> <fieldset> <div class="form-field advanced-option"> <label for="parameter-distinguished">Mod</label> <div class="select"> <select name="distinguished" id="parameter-distinguished" data-default-value="any" title="Limit to distinguished items or vice versa" > <option value="any">Any</option> <option value="moderator">True</option> <option value="!moderator">False</option> </select> <span class="expand-icon"></span> </div> </div> <div class="form-field advanced-option"> <label for="parameter-stickied">Stickied</label> <div class="select"> <select name="stickied" id="parameter-stickied" data-default-value="any" title="Limit to stickied/pinned items or vice versa" > <option value="any">Any</option> <option value="true">True</option> <option value="false">False</option> </select> <span class="expand-icon"></span> </div> </div> <div class="form-field advanced-option"> <label for="parameter-locked">Locked</label> <div class="select"> <select name="locked" id="parameter-locked" class="submissions-only" data-default-value="any" title="Limit to locked items or vice versa" > <option value="any">Any</option> <option value="true">True</option> <option value="false">False</option> </select> <span class="expand-icon"></span> </div> </div> <div class="form-field advanced-option"> <label for="parameter-over_18">NSFW</label> <div class="select"> <select name="over_18" id="parameter-over_18" class="submissions-only" data-default-value="any" title="Limit to NSFW submissions or vice versa (applies to submissions)" > <option value="any">Any</option> <option value="false">False</option> <option value="true">True</option> </select> <span class="expand-icon"></span> </div> </div> <div class="form-field advanced-option"> <label for="parameter-is_self">Is Self</label> <div class="select"> <select name="is_self" id="parameter-is_self" class="submissions-only" data-default-value="any" title="Limit to selfpost (text) submissions or vice versa (applies to submissions)" > <option value="any">Any</option> <option value="true">True</option> <option value="false">False</option> </select> <span class="expand-icon"></span> </div> </div> <div class="form-field advanced-option"> <label for="parameter-meta_state">State<span class="label-tag">FILTER</span></label> <div class="select"> <select name="meta_state" id="parameter-meta_state" data-default-value="any" title="Limit to live, deleted, or removed items." > <option value="any">Any</option> <option value="live">Live</option> <option value="deleted">Deleted</option> <option value="removed">Removed</option> <option value="deleted+removed">Deleted or Removed</option> </select> <span class="expand-icon"></span> </div> </div> </fieldset> <fieldset class="advanced-option dev-option"> <div class="form-field advanced-option"> <label for="parameter-ids">ID(s)</label> <input type="text" name="ids[]" id="parameter-ids" placeholder="ID(s)" spellcheck="false" autocomplete="off" pattern="^[a-zA-Z0-9]{3,8}([\s,+]+[a-zA-Z0-9]{3,8})*$" title="Specify individual item IDs (e.g. lo390z,lo4xsb) (dependent on item type)" /> </div> <div class="form-field advanced-option"> <label for="parameter-link_id">Link ID</label> <input type="text" name="link_id[]" id="parameter-link_id" class="comments-only" placeholder="Link ID" spellcheck="false" autocomplete="off" pattern="^(t3_)?[a-zA-Z0-9]{3,8}([\s,+]+(t3_)?[a-zA-Z0-9]{3,8})*$" title="Specify individual item link ID (e.g. lo390z) (applies to comments)" /> </div> </fieldset> <fieldset> <div class="form-field"> <label for="parameter-meta_type">Type</label> <div class="select"> <select name="meta_type" id="parameter-meta_type" data-default-value="any" title="Limit to items of type (submission, comment, or both)" > <option value="any">Any</option> <option value="submission">Submissions</option> <option value="comment">Comments</option> </select> <span class="expand-icon"></span> </div> </div> <div class="form-field"> <label for="parameter-sort">Sort</label> <div class="select"> <select name="sort" id="parameter-sort" data-default-value="desc" title="Search sorting (newest to oldest or oldest to newest)" > <option value="desc">Descending</option> <option value="asc">Ascending</option> </select> <span class="expand-icon"></span> </div> </div> <div class="form-field"> <label for="parameter-limit">Limit</label> <input type="number" name="limit" id="parameter-limit" placeholder="Limit" min="1" title="Limit to x number of results (per item type)" /> </div> <div class="form-field advanced-option dev-option"> <label for="parameter-limit">API<span class="label-tag">EXPERIMENTAL</span></label> <div class="select"> <select name="meta_api" id="parameter-meta_api" data-default-value="pushshift" title="Search API" > <option value="pushshift">Pushshift</option> <option value="coddit">Coddit (Limited)</option> </select> <span class="expand-icon"></span> </div> </div> </fieldset> <div class="option-group advanced-option"> <div class="form-field-inline"> <label class="check-container" for="parameter-meta_search_exact" ><span>Require Exact Match</span><span class="label-tag">FILTER</span> <input type="checkbox" name="meta_search_exact" id="parameter-meta_search_exact" value="true" data-dependent-on="parameter-q" title="Require exact search match (dependent on Search Terms)" /> <span class="checkmark"></span> </label> </div> <div class="form-field-inline dev-option"> <label class="check-container" for="parameter-metadata" ><span>Include Metadata</span> <input type="checkbox" name="metadata" id="parameter-metadata" value="false" /> <span class="checkmark"></span> </label> </div> </div> <div class="option-group"> <div class="form-field-inline"> <input type="reset" id="form-reset" /> <input type="submit" id="form-submit" value="Search" /> </div> </div> </form> </div> </header> <main> <div id="items-panel" class="panel collapsed"> <h1 class="panel-header"> Results - <span id="item-count"></span> Items<button class="panel-collapse">Expand</button> </h1> <div id="items"></div> <h3 id="banner">No Data</h3> <button id="load-more-button" data-page-count="1" hidden>Load Before</button> </div> <div id="info-panel" class="panel collapsed advanced-option"> <h1 class="panel-header">Results Info<button class="panel-collapse">Expand</button></h1> <div id="info"></div> </div> <div id="requests-panel" class="panel collapsed advanced-option dev-option"> <h1 class="panel-header">Request History<button class="panel-collapse">Expand</button></h1> <table id="request-table"> <thead> <tr> <th>Request URL</th> <th>Status</th> <th>Request #</th> </tr> </thead> <tbody></tbody> </table> </div> <div class="panel collapsed advanced-option"> <h1 class="panel-header">Extra Options<button class="panel-collapse">Expand</button></h1> <button id="download-button" style="margin: 4px; padding: 8px">Download Data</button> </div> </main> <script>function gel(e){return document.getElementById(e)}function gels(e){return Array.from(document.getElementsByClassName(e))}function qel(e){return document.querySelector(e)}function qels(e){return Array.from(document.querySelectorAll(e))}function celfprops(e){const t=e=>null!=e&&""!==e&&e!==[]&&e!=={};let n=document.createElement("div");if(e.tagName&&t(e.tagName)&&(n=document.createElement(e.tagName)),e.fromString&&t(e.fromString)&&(n=(new DOMParser).parseFromString(string,"text/html").body.firstChild),null!=e.innerHTML)if(Array.isArray(e.innerHTML)){for(let a of e.innerHTML)if(t(a))if(a instanceof HTMLElement)n.appendChild(a);else{let e=document.createElement("span");e.innerHTML=a,n.appendChild(e)}}else t(e.innerHTML)&&(e.innerHTML instanceof HTMLElement?n.appendChild(e.innerHTML):n.innerHTML=e.innerHTML);if(e.classList)if(Array.isArray(e.classList))for(let a of e.classList)t(a)&&n.classList.add(a);else t(e.classList)&&(n.classList=e.classList);if(e.id&&t(e.id)&&(n.id=e.id),e.attributes)if(Array.isArray(e.attributes))for(let a of e.attributes)Array.isArray(a)?a.length>1&&t(a[0])&&t(a[1])?n.setAttribute(a[0],a[1]):a.length&&t(a[0])&&n.setAttribute(a[0],""):t(a)&&n.setAttribute(a,"");else if("object"==typeof e.attributes)for(let[a,l]of Object.entries(e.attributes))t(a=a.replace(/_/g,"-").replace(/[^a-z0-9-]/gi,""))&&t(l)?n.setAttribute(a,l):t(a)&&n.setAttribute(a,"");else if("string"==typeof e.attributes)for(let a of e.attributes.split(/ +/))t(a=a.replace(/[^a-z0-9-]/gi,""))&&n.setAttribute(a,"");if(e.eventListeners&&"object"==typeof e.eventListeners)for(let[a,l]of Object.entries(e.eventListeners))t(a=a.replace(/[^a-z0-9-]/gi,""))&&"function"==typeof l&&n.addEventListener(a,l);for(const[a,l]of Object.entries(e))-1==["tagName","fromString","innerHTML","classList","id","attributes","eventListeners"].indexOf(a)&&("function"==typeof l?n[a]=l:t(a)&&t(l)&&n.setAttribute(a,l));return n}function celp(e,t,n){return n.tagName=e,n.innerHTML=t,celfprops(n)}function cel(e,t,n,a){let l=document.createElement(e);if(null!=t)if(Array.isArray(t))for(let e of t)e&&(e instanceof HTMLElement?l.appendChild(e):l.innerHTML=e);else t instanceof HTMLElement?l.appendChild(t):l.innerHTML=t;if(n)if(Array.isArray(n))for(let e of n)e&&l.classList.add(e);else l.classList=n;return a&&(l.id=a),l}function celwa(e,t,n,a,l){let r=cel(e,n,a,l);return t.forEach(e=>{e&&(e[1]?r.setAttribute(e[0],e[1]):r.setAttribute(e[0]))}),r}function celfs(e){return(new DOMParser).parseFromString(e,"text/html").body.firstChild}function getParams(){return new URLSearchParams(window.location.search)}function getParam(e){params=getParams();let t=null;return params.has(e)&&(t=params.get(e)),t}function setParam(e,t){newParams=getParams(),newParams.has(e)&&newParams.delete(e),newParams.append(e,t),""!=newParams.toString()?history.pushState({cleared:e},`cleared ${e}`,window.location.href.split("?")[0]+"?"+newParams.toString()):history.pushState({cleared:e},`cleared ${e}`,window.location.href.split("?")[0])}function clearParam(e){newParams=getParams(),newParams.has(e)&&newParams.delete(e),""!=newParams.toString()?history.pushState({cleared:e},`cleared ${e}`,window.location.href.split("?")[0]+"?"+newParams.toString()):history.pushState({cleared:e},`cleared ${e}`,window.location.href.split("?")[0])}function clearParams(){for(param of(newParams=getParams(),newParams))clearParam(param)}function checkParam(e,t){return params=getParams(),params.has(e)&&params.get(e)==t}function rands(e){let t="acbdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",n="";for(let a=0;a<e;a++)n+=t.charAt(Math.floor(Math.random()*t.length));return n}function array_remove(e,t){e.indexOf(t)>-1&&e.splice(e.indexOf(t),1)}function escapeRegExp(e){return e.replace(/[.*+?^${}()|\[\]\\]/g,"\\$&")}function copyText(e){if(navigator)navigator.clipboard.writeText(e).then(()=>{console.debug("copied text")},()=>{console.warn("failed to copy text")});else{let t=cel("textarea");t.style.position="absolute",t.style.top=t.style.left="-9999px",t.style.width=t.style.height="0px",t.style.opacity="0",t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),console.debug("copied text")}}function downloadText(e,t="file.txt"){let n=new Blob([e],{type:"text/plain"}),a=cel("a");a.download=t,a.href=URL.createObjectURL(n),a.dataset.downloadUrl=["text/plain",a.download,a.href].join(":"),a.style.display="none",document.body.appendChild(a),a.click(),a.remove(),setTimeout(()=>{URL.revokeObjectURL(a.href)},2e3)}function downloadFile(e,t,n){let a=new Blob([e],{type:n});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(a,t);else{let e=document.createElement("a"),n=URL.createObjectURL(a);e.href=n,e.download=t,document.body.appendChild(e),e.click(),setTimeout(()=>{window.URL.revokeObjectURL(n)},100)}}function tableify(e,t,n=!0,a=!1){if("object"==typeof e&&null!==e){let l=cel("tbody"),r=cel("table",l,["property-table",a?"simplified":null]);for(const[r,s]of Object.entries(e)){let e=t?parseInt(r)||0==r?t+"["+r+"]":t+"."+r:parseInt(r)||0==r?"["+r+"]":r,i=cel("tr",null,"property"),c=cel("td",a?r.replace(/_/g," ").replace(/(?:^|\s)(.)/g,function(e){return e.toUpperCase()}):r,["key",parseInt(r)||0==r?"index":null]);c.title=e;let o=cel("td",null,"value");o.title=JSON.stringify(s).length>100?JSON.stringify(s).substring(0,97)+"...":JSON.stringify(s);let u=celwa("a",[["href","javascript:void(0);"]],null,"placeholder");c.onclick=(()=>{i.classList.contains("expanded")&&(o.innerHTML="",o.appendChild(u),i.classList.remove("expanded"))}),u.onclick=(()=>{o.innerHTML="",o.appendChild(tableify(s,e,n,a)),i.classList.add("expanded")}),Array.isArray(s)?(i.classList.add("expandable"),i.classList.add("array"),0!=s.length?(u.innerHTML="[...] "+s.length+" item"+(1==s.length?"":"s"),i.classList.add("populated")):(u.innerHTML="[] empty",i.classList.add("empty")),n?(o.innerHTML="",o.appendChild(u)):(i.classList.add("expanded"),o.innerHTML="",o.appendChild(tableify(s,e,n,a)))):"object"==typeof s&&null!==s?(i.classList.add("expandable"),i.classList.add("object"),0!=Object.keys(s).length?(u.innerHTML="{...} "+Object.keys(s).length+" key"+(1==Object.keys(s).length?"":"s"),i.classList.add("populated")):(u.innerHTML="{} empty",i.classList.add("empty")),n?(o.innerHTML="",o.appendChild(u)):(i.classList.add("expanded"),o.innerHTML="",o.appendChild(tableify(s,e,n,a)))):null===s?i.classList.add("null"):"boolean"==typeof s?(i.classList.add("boolean"),i.classList.add(s),o.innerHTML=s):"string"==typeof s?(i.classList.add("string"),s.length>0?i.classList.add("populated"):i.classList.add("empty"),o.innerHTML=s.replace(/\n/g,"<br>"),o.innerHTML=o.innerHTML.replace(/(https?:\/\/[^\s<>]+)/g,'<a href="$1">$1</a>')):Number.isInteger(s)?(i.classList.add("number"),i.classList.add("integer"),o.innerHTML=s):Number.isNaN(s)?o.innerHTML=s:(i.classList.add("number"),i.classList.add("float"),o.innerHTML=s),i.appendChild(c),i.appendChild(o),l.appendChild(i)}return r}return e}function randomInt(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function sliceArray(e,t){const n=[];for(let a=0;a<e.length;a+=t){const l=e.slice(a,a+t);n.push(l)}return n}function ajaxSubmitForm(e){return fetch(e.action,{method:"POST",body:new FormData(e)})}function setCookie(e,t,n=1,a="/"){let l="";if(n){let e=new Date;e.setTime(e.getTime()+24*n*60*60*1e3),l="; expires"+e.toUTCString()}document.cookie=e+"="+(t||"")+l+"; path="+a}function getCookie(e){const t=`; ${document.cookie}`.split(`; ${e}=`);if(2===t.length)return t.pop().split(";").shift()}function getCookies(){let e=document.cookie.split(";"),t={};return e.forEach(e=>{e=e.split("="),t[(e[0]+"").trim()]=unescape(e.slice(1).join("="))}),t}function deleteCookie(e){document.cookie=e+"=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}function deleteCookies(){document.cookie.split(";").forEach(e=>{let t=e.indexOf("="),n=t>-1?e.substr(0,t):e;document.cookie=n+"=; expires Thu, 01 Jan 1970 00:00:01 GMT"})}function time(){return Date.now()/1e3|0}function sleep(e){return new Promise(t=>setTimeout(t,e))}function decodeHTML(e){return(new DOMParser).parseFromString(e,"text/html").documentElement.textContent}function getPos(e){let t=e.getBoundingClientRect(),n=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,a=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,l=document.documentElement.clientTop||document.body.clientTop||0,r=document.documentElement.clientLeft||document.body.clientLeft||0,s=t.top+n-l,i=t.left+a-r;return[Math.round(s),Math.round(i)]}function setDraggable(e,t){t||(t=e);let n,a,l,r=0;function s(t){(t=t||window.event).preventDefault(),n=l-t.clientX,a=r-t.clientY,l=t.clientX,r=t.clientY,e.style.top=e.offsetTop-a+"px",e.style.left=e.offsetLeft-n+"px"}function i(t){document.onmouseup=null,document.onmousemove=null,e.classList.remove("dragging")}t.onmousedown=function(t){(t=t||window.event).preventDefault(),l=t.clientX,r=t.clientY,document.onmouseup=i,document.onmousemove=s,e.classList.add("dragging")}}function openDialog(e,t,n,a,l,r,s){document.body.querySelectorAll("."+s).forEach(e=>e.remove()),e.classList.add("dialog-menu"),e.classList.add(s),e.style.position="absolute",e.style.top=t+"px",e.style.left=n+"px",a&&l&&setDraggable(e,l),r&&(r.onclick=(()=>e.remove())),document.body.appendChild(e)}function round(e,t=2){return Math.round((e+Number.EPSILON)*parseInt("1"+"0".repeat(t)))/parseInt("1"+"0".repeat(t))}function decodeHTML(e){return(new DOMParser).parseFromString(e,"text/html").documentElement.textContent}function formatTime(e,t){e=parseInt(e);let n="second";for(let a of[["year",31556926],["month",2629743],["week",604800],["day",86400],["hour",3600],["minute",60]])if(e>a[1]){e=t&&t.useDecimal?round(e/a[1]):Math.floor(e/a[1]),n=a[0];break}return`${e} ${n+(1!=e?"s":"")}`}function abbreviateNumber(e){let t=e;return e>1e3&&(t=round(e/1e3,1)+"k"),t}function commaSeparateNumber(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function mdHighlight(e,t){try{e=e.replace(new RegExp("(?<!<[^<>]+?)("+t+")(?![^<>]+?>)","gi"),'<span class="highlighted">$1</span>')}catch(n){console.error(n),e=e.replace(new RegExp("("+t+")","gi"),'<span class="highlighted">$1</span>')}return e}function mdParseBasic(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/((?:(?:^&gt;[^\n]*)(?:\n+(?=&gt;))?)+)/gm,"<blockquote>\n$1\n</blockquote>")).replace(/^&gt;\s*/gm,"")).replace(/((?:(?:^ {4}[^\n]*)(?:\n+(?= {4}))?)+)/gm,"<pre><code>$1</code></pre>")).replace(/^(<pre><code>)? {4}/gm,"$1\x3c!-- CODE_LINE --\x3e")).replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>")).replace(/\*(.+?)\*/g,"<em>$1</em>")).replace(/~~(.+?)~~/g,"<del>$1</del>")).replace(/`(.+?)`/g,"<code>$1</code>")).replace(/^[-+*]\s+(.+?)$/gm,"\x3c!-- UL_ITEM --\x3e<li>$1</li>")).replace(/((?:(?:<!-- UL_ITEM --><li>[^\n]*)(?:\n+(?=<!-- UL_ITEM -->))?)+)/g,"<ul>\n$1\n</ul>")).replace(/^\d+\.\s+(.+?)$/gm,"\x3c!-- OL_ITEM --\x3e<li>$1</li>")).replace(/((?:(?:<!-- OL_ITEM --><li>[^\n]*)(?:\n+(?=<!-- OL_ITEM -->))?)+)/g,"<ol>\n$1\n</ol>")).replace(/^(?:-{3,}|_{3,}|\*{3,}|~{3,}|={3,}|\+{3,})$/gm,"<hr>")).replace(/^######\s*(.+)$/gm,"<h6>$1</h6>")).replace(/^#####\s*(.+)$/gm,"<h5>$1</h5>")).replace(/^####\s*(.+)$/gm,"<h4>$1</h4>")).replace(/^###\s*(.+)$/gm,"<h3>$1</h4>")).replace(/^##\s*(.+)$/gm,"<h2>$1</h2>")).replace(/^#\s*(.+)$/gm,"<h1>$1</h1>")).replace(/\^\((.+?)\)/g,"<sup>$1</sup>")).replace(/\^([^\s\^]+)/g,"<sup>$1</sup>")).replace(/\[(.+?)\]\((.+?)\)/g,'<a href="$2">$1</a>')).replace(/(^|\s)\/?([ru]\/[a-z0-9\/_.-]+)/gim,'$1<a href="https://www.reddit.com/$2">$2</a>')).replace(/(^|\s)(https?:\/\/\S+)/gim,'$1<a href="$2">$2</a>')).replace(/^((?:.+?\|)+.+)$/gm,"<tr><td>$1</td></tr>")).replace(/^<tr><td>(.+?)<\/td><\/tr>/gm,function(e,t){let n="";return t.split("|").forEach(e=>n+="<td>"+e+"</td>"),"<tr>"+n+"</tr>"})).replace(/((?:^<tr>.+?<\/tr>(\n(?=<tr>))?)+)/gm,"<table>\n<tbody>\n$1\n</tbody>\n</table>")).replace(/<tbody>\n(<tr>.+?<\/tr>)\n<tr>.+?<\/tr>/gm,"<thead>\n$1\n</thead>\n<tbody>")).replace(/^<thead>\n.+?\n<\/thead>/gm,function(e){return e.replace(/<td>/g,"<th>").replace(/<\/td>/g,"</th>")})).replace(/^(?!<\/?(?:!--|(?:blockquote|codeblock|code|pre|h[123456r]|li|[uo]l|t[rd]|table|thead|tbody)>))(.+?)$/gm,"<p>\n$1\n</p>")).replace(/^(.+?) {2,}$/gm,"$1\n<br>\n")).replace(/\n+/g,"\n")).replace(/\\/g,"")).replace(/<!-- .+? -->/g,"")).replace(/&amp;/g,"&").replace(/&nbsp;/g," ")}!function(e){function t(e){return" "==e||"\n"==e}function n(e){return/[\x09-\x0d ]/.test(e)}function a(e){return/[A-Za-z0-9]/.test(e)}function l(e){return/[A-Za-z]/.test(e)}function r(e){return/[0-9]/.test(e)}function s(e){return/[0-9a-fA-F]/.test(e)}function i(e){return/[\x20-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]/.test(e)}function c(e){return"%"+"0123456789ABCDEF"[(240&e)>>4]+"0123456789ABCDEF"[(15&e)>>0]}function o(e){var t=e.charCodeAt(0);if(t<128)return c(t);if(t>127&&t<2048){var n=c(t>>6&255|192);return n+=c(t>>0&63|128)}n=c(t>>12&255|224);return n+=c(t>>6&63|128),n+=c(t>>0&63|128)}function u(e,t){var a,l=0,r=e.length;if(r<3||"<"!=e[0])return We;"/"==e[a=1]&&(l=1,a++);for(var s=0;a<r&&!(s>=t.length);++a,++s)if(e[a]!=t[s])return We;return a==r?We:n(e[a])||">"==e[a]?l?Ve:Ge:We}function d(e,t){for(var n,a=0;a<t.s.length;){for(n=a;a<t.s.length&&"\\"!=t.s[a];)a++;if(a>n&&(e.s+=t.s.slice(n,a)),a+1>=t.s.length)break;e.s+=t.s[a+1],a+=2}}var f=1114111;var h=7,p=["&AElig;","&Aacute;","&Acirc;","&Agrave;","&Alpha;","&Aring;","&Atilde;","&Auml;","&Beta;","&Ccedil;","&Chi;","&Dagger;","&Delta;","&ETH;","&Eacute;","&Ecirc;","&Egrave;","&Epsilon;","&Eta;","&Euml;","&Gamma;","&Iacute;","&Icirc;","&Igrave;","&Iota;","&Iuml;","&Kappa;","&Lambda;","&Mu;","&Ntilde;","&Nu;","&OElig;","&Oacute;","&Ocirc;","&Ograve;","&Omega;","&Omicron;","&Oslash;","&Otilde;","&Ouml;","&Phi;","&Pi;","&Prime;","&Psi;","&Rho;","&Scaron;","&Sigma;","&THORN;","&Tau;","&Theta;","&Uacute;","&Ucirc;","&Ugrave;","&Upsilon;","&Uuml;","&Xi;","&Yacute;","&Yuml;","&Zeta;","&aacute;","&acirc;","&acute;","&aelig;","&agrave;","&alefsym;","&alpha;","&amp;","&and;","&ang;","&apos;","&aring;","&asymp;","&atilde;","&auml;","&bdquo;","&beta;","&brvbar;","&bull;","&cap;","&ccedil;","&cedil;","&cent;","&chi;","&circ;","&clubs;","&cong;","&copy;","&crarr;","&cup;","&curren;","&dArr;","&dagger;","&darr;","&deg;","&delta;","&diams;","&divide;","&eacute;","&ecirc;","&egrave;","&empty;","&emsp;","&ensp;","&epsilon;","&equiv;","&eta;","&eth;","&euml;","&euro;","&exist;","&fnof;","&forall;","&frac12;","&frac14;","&frac34;","&frasl;","&gamma;","&ge;","&gt;","&hArr;","&harr;","&hearts;","&hellip;","&iacute;","&icirc;","&iexcl;","&igrave;","&image;","&infin;","&int;","&iota;","&iquest;","&isin;","&iuml;","&kappa;","&lArr;","&lambda;","&lang;","&laquo;","&larr;","&lceil;","&ldquo;","&le;","&lfloor;","&lowast;","&loz;","&lrm;","&lsaquo;","&lsquo;","&lt;","&macr;","&mdash;","&micro;","&middot;","&minus;","&mu;","&nabla;","&nbsp;","&ndash;","&ne;","&ni;","&not;","&notin;","&nsub;","&ntilde;","&nu;","&oacute;","&ocirc;","&oelig;","&ograve;","&oline;","&omega;","&omicron;","&oplus;","&or;","&ordf;","&ordm;","&oslash;","&otilde;","&otimes;","&ouml;","&para;","&part;","&permil;","&perp;","&phi;","&pi;","&piv;","&plusmn;","&pound;","&prime;","&prod;","&prop;","&psi;","&quot;","&rArr;","&radic;","&rang;","&raquo;","&rarr;","&rceil;","&rdquo;","&real;","&reg;","&rfloor;","&rho;","&rlm;","&rsaquo;","&rsquo;","&sbquo;","&scaron;","&sdot;","&sect;","&shy;","&sigma;","&sigmaf;","&sim;","&spades;","&sub;","&sube;","&sum;","&sup1;","&sup2;","&sup3;","&sup;","&supe;","&szlig;","&tau;","&there4;","&theta;","&thetasym;","&thinsp;","&thorn;","&tilde;","&times;","&trade;","&uArr;","&uacute;","&uarr;","&ucirc;","&ugrave;","&uml;","&upsih;","&upsilon;","&uuml;","&weierp;","&xi;","&yacute;","&yen;","&yuml;","&zeta;","&zwj;","&zwnj;"],m=[7,7,7,7,7,7,7,7,7,0,0,7,7,0,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,0,0,1,0,0,0,2,3,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,5,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],g=["","&quot;","&amp;","&#39;","&#47;","&lt;","&gt;",""];function b(e,t,n){for(var a,l=0,r=0;l<t.length;){for(a=l;l<t.length&&!(r=m[t.charCodeAt(l)]);)l++;if(l>a&&(e.s+=t.slice(a,l)),l>=t.length)break;"/"!=t[l]||n?7==m[t.charCodeAt(l)]||(e.s+=g[r]):e.s+="/",l++}}var k=[2,2,2,2,2,2,2,2,2,0,0,2,2,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,1,0,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];function v(e,t){for(var n,a=0;a<t.length;){for(n=a;a<t.length&&1===k[t.charCodeAt(a)];)a++;if(a>n&&(e.s+=t.slice(n,a)),a>=t.length)break;if(2!=k[t.charCodeAt(a)]){switch(t[a]){case"&":e.s+="&amp;";break;case"'":e.s+="&#x27;";break;default:e.s+=o(t[a])}a++}else a++}}function _(e,t,n,a){var r,s,i=e.slice(n),c=0;for(s=0;s<t;++s)if("<"==i[s]){t=s;break}for(;t>0;){var o=i[t-1];if("\0"===o)break;if(-1!=="?!.,".indexOf(o))t--;else{if(";"!==o)break;for(var u=t-2;u>0&&l(i[u]);)u--;u<t-2&&"&"==i[u]?t=u:t--}}if(0==t)return 0;switch(r=i[t-1]){case'"':c='"';break;case"'":c="'";break;case")":c="(";break;case"]":c="[";break;case"}":c="{"}if(0!=c){for(var d=0,f=0,h=0;h<t;)i[h]==c?f++:i[h]==r&&d++,h++;d!=f&&t--}return t}function w(e,t){var n,l=0;if(!a(e[0]))return 0;for(n=1;n<e.length-1;++n)if("."==e[n])l++;else if(!a(e[n])&&"-"!=e[n])break;return t?n:l?n:0}function L(e){var t,n=["http://","https://","ftp://","mailto://","/","git://","steam://","irc://","news://","mumble://","ssh://","ircs://","ts3server://","#"];for(t=0;t<n.length;++t){var a=n[t].length;if(e.length>a&&0==e.toLowerCase().indexOf(n[t])&&/[A-Za-z0-9#\/?]/.test(e[a]))return 1}return 0}function y(e){if(e)for(var t in e)t in this&&(this[t]=e[t])}function x(e,t){this.callbacks=e,this.context=t}function S(){return{nofollow:0,target:null,tocData:{headerCount:0,currentLevel:0,levelOffset:0},toc_id_prefix:null,html_element_whitelist:Pt,html_attr_whitelist:Et,flags:0,link_attributes:function(e,t,n){n.nofollow&&(e.s+=' rel="nofollow"'),null!=n.target&&(e.s+=' target="'+n.target+'"')}}}function T(e){var t=S();t.flags=null==e?Tt:e;var n=new x(C(),t);return n.context.flags&Ae&&(n.callbacks.image=null),n.context.flags&Oe&&(n.callbacks.link=null,n.callbacks.autolink=null),(n.context.flags&$e||n.context.flags&Ue)&&(n.callbacks.blockhtml=null),n}function C(){return new y({blockcode:P,blockquote:M,blockhtml:I,header:$,hrule:q,list:A,listitem:O,paragraph:H,table:D,table_row:R,table_cell:N,autolink:U,codespan:j,double_emphasis:K,emphasis:B,image:F,linebreak:z,link:X,raw_html_tag:G,triple_emphasis:V,strikethrough:Y,superscript:Q,entity:null,normal_text:J,doc_header:null,doc_footer:te})}function E(){return new y({blockcode:null,blockquote:null,blockhtml:null,header:Z,hrule:null,list:null,listitem:null,paragraph:null,table:null,table_row:null,table_cell:null,autolink:null,codespan:j,double_emphasis:K,emphasis:B,image:null,linebreak:null,link:ee,raw_html_tag:null,triple_emphasis:V,strikethrough:Y,superscript:Q,entity:null,normal_text:null,doc_header:null,doc_footer:ne})}function P(e,t,a,l){if(e.s.length&&(e.s+="\n"),a&&a.s.length){var r,s;for(e.s+='<pre><code class="',r=0,s=0;r<a.s.length;++r,++s){for(;r<a.s.length&&n(a.s[r]);)r++;if(r<a.s.length){for(var i=r;r<a.s.length&&!n(a.s[r]);)r++;"."==a.s[i]&&i++,s&&(e.s+=" "),b(e,a.s.slice(i,r),!1)}}e.s+='">'}else e.s+="<pre><code>";t&&b(e,t.s,!1),e.s+="</code></pre>\n"}function M(e,t,n){e.s.length&&(e.s+="\n"),e.s+="<blockquote>\n",t&&(e.s+=t.s),e.s+="</blockquote>\n"}function I(e,t,n){var a,l;if(t){for(l=t.s.length;l>0&&"\n"==t.s[l-1];)l--;for(a=0;a<l&&"\n"==t.s[a];)a++;a>=l||(e.s.length&&(e.s+="\n"),e.s+=t.s.slice(a,l),e.s+="\n")}}function $(e,t,n,a){e.s.length&&(e.s+="\n"),a.flags&De?(e.s+="<h"+ +n+' id="',a.toc_id_prefix&&(e.s+=a.toc_id_prefix),e.s+="toc_"+a.tocData.headerCount+++'">'):e.s+="<h"+ +n+">",t&&(e.s+=t.s),e.s+="</h"+ +n+">\n"}function q(e,t){e.s.length&&(e.s+="\n"),e.s+=t.flags&Ne?"<hr/>\n":"<hr>\n"}function A(e,t,n,a){e.s.length&&(e.s+="\n"),e.s+=n&le?"<ol>\n":"<ul>\n",t&&(e.s+=t.s),e.s+=n&le?"</ol>\n":"</ul>\n"}function O(e,t,n,a){if(e.s+="<li>",t){for(var l=t.s.length;l&&"\n"==t.s[l-1];)l--;e.s+=t.s.slice(0,l)}e.s+="</li>\n"}function H(e,t,a){var l=0;if(e.s.length&&(e.s+="\n"),t&&t.s.length){for(;l<t.s.length&&n(t.s[l]);)l++;if(l!=t.s.length){if(e.s+="<p>",a.flags&Re)for(var r;l<t.s.length;){for(r=l;l<t.s.length&&"\n"!=t.data[l];)l++;if(l>r&&(e.s+=t.s.slice(r,l)),l>=t.s.length-1)break;z(e,a),l++}else e.s+=t.s.slice(l);e.s+="</p>\n"}}}function D(e,t,n,a){e.s.length&&(e.s+="\n"),e.s+="<table><thead>\n",t&&(e.s+=t.s),e.s+="</thead><tbody>\n",n&&(e.s+=n.s),e.s+="</tbody></table>\n"}function R(e,t,n){e.s+="<tr>\n",t&&(e.s+=t.s),e.s+="</tr>\n"}function N(e,t,n,a,l){switch(e.s+=n&Xe?"<th":"<td",l>1&&(e.s+=' colspan="'+l+'" '),n&ze){case Fe:e.s+=' align="center">';break;case Ke:e.s+=' align="left">';break;case Be:e.s+=' align="right">';break;default:e.s+=">"}t&&(e.s+=t.s),e.s+=n&Xe?"</th>\n":"</td>\n"}function U(e,t,n,a){return t&&t.s.length&&(0==(a.flags&He)||L(t.s)||n==ye)?(e.s+='<a href="',n==ye&&(e.s+="mailto:"),v(e,t.s.slice(0)),a.link_attributes?(e.s+='"',a.link_attributes(e,t,a),e.s+=">"):e.s+='">',0==t.s.indexOf("mailto:")?b(e,t.s.slice(7),!1):b(e,t.s,!1),e.s+="</a>",1):0}function j(e,t,n){return e.s+="<code>",t&&b(e,t.s,!1),e.s+="</code>",1}function K(e,t,n){return t&&t.s.length?(e.s+="<strong>"+t.s+"</strong>",1):0}function B(e,t,n){return t&&t.s.length?(e.s+="<em>"+t.s+"</em>",1):0}function F(e,t,n,a,l){return t&&t.s.length?(e.s+='<img src="',v(e,t.s),e.s+='" alt="',a&&a.s.length&&b(e,a.s,!1),n&&n.s.length&&(e.s+='" title="',b(e,n.s,!1)),e.s+=l.flags&Ne?'"/>':'">',1):0}function z(e,t){return e.s+=t.flags&Ne?"<br/>\n":"<br>\n",1}function X(e,t,n,a,l){return null==t||0==(l.flags&He)||L(t.s)?(e.s+='<a href="',t&&t.s.length&&v(e,t.s),n&&n.s.length&&(e.s+='" title="',b(e,n.s,!1)),l.link_attributes?(e.s+='"',l.link_attributes(e,t,l),e.s+=">"):e.s+='">',a&&a.s.length&&(e.s+=a.s),e.s+="</a>",1):0}function W(e,t,n,a,l,r){var s,i,c,o,u,d=0,f=0,h=0,p=0,m=0;if(e.s+="<",r!=Ve){e.s+=a;var g=1+a.length;for(c=new Ye,o=new Ye;g<t.s.length&&!h;g++){switch(h=0,m=0,p=0,u=t.s[g]){case">":h=1;break;case"'":case'"':f?d?d==u?(d=0,p=1):o.s+=u:d=u:m=1;break;case" ":d?o.s+=" ":m=1;break;case"=":if(f){m=1;break}f=1;break;default:(f&&d||!f)&&(f?o.s+=u:c.s+=u)}if(p){var k=0;for(i=0;l[i];i++)if(l[i].length==c.s.length){for(s=0;s<c.s.length&&l[i][s].toLowerCase()==c.s[s].toLowerCase();s++);if(s==c.s.length){k=1;break}}k&&o.s.length&&c.s.length&&(e.s+=" ",b(e,c.s,!1),e.s+='="',b(e,o.s,!1),e.s+='"'),m=1}m&&(f=0,d=0,c=new Ye,o=new Ye)}e.s+=">"}else e.s+="/"+a+">"}function G(e,t,n){var a=n.html_element_whitelist;if(0!=(n.flags&je)&&a)for(var l=0;a[l];l++){var r=u(t.s,a[l]);if(r!=We)return W(e,t,0,a[l],n.html_attr_whitelist,r),1}return 0!=(n.flags&Ue)?(b(e,t.s,!1),1):0!=(n.flags&$e)?1:0!=(n.flags&qe)&&u(t.s,"style")?1:0!=(n.flags&Oe)&&u(t.s,"a")?1:0!=(n.flags&Ae)&&u(t.s,"img")?1:(e.s+=t.s,1)}function V(e,t,n){return t&&t.s.length?(e.s+="<strong><em>"+t.s+"</em></strong>",1):0}function Y(e,t,n){return t&&t.s.length?(e.s+="<del>"+t.s+"</del>",1):0}function Q(e,t,n){return t&&t.s.length?(e.s+="<sup>"+t.s+"</sup>",1):0}function J(e,t,n){t&&b(e,t.s,!1)}function Z(e,t,n,a){if(0==a.tocData.currentLevel&&(e.s+='<div class="toc">\n',a.tocData.levelOffset=n-1),(n-=a.tocData.levelOffset)>a.tocData.currentLevel)for(;n>a.tocData.currentLevel;)e.s+="<ul>\n<li>\n",a.tocData.currentLevel++;else if(n<a.tocData.currentLevel){for(e.s+="</li>\n";n<a.tocData.currentLevel;)e.s+="</ul>\n</li>\n",a.tocData.currentLevel--;e.s+="<li>\n"}else e.s+="</li>\n<li>\n";e.s+='<a href="#',a.toc_id_prefix&&(e.s+=a.toc_id_prefix),e.s+="toc_"+a.tocData.headerCount+++'">',t&&b(e,t.s,!1),e.s+="</a>\n"}function ee(e,t,n,a,l){return a&&a.s&&(e.s+=a.s),1}function te(e,t){t.tocData={headerCount:0,currentLevel:0,levelOffset:0}}function ne(e,t){for(var n=!1;t.tocData.currentLevel>0;)e.s+="</li>\n</ul>\n",t.tocData.currentLevel--,n=!0;n&&(e.s+="</div>\n"),te(0,t)}y.prototype={blockcode:null,blockquote:null,blockhtml:null,header:null,hrule:null,list:null,listitem:null,paragraph:null,table:null,table_row:null,table_cell:null,autolink:null,codespan:null,double_emphasis:null,emphasis:null,image:null,linebreak:null,link:null,raw_html_tag:null,triple_emphasis:null,strikethrough:null,superscript:null,entity:null,normal_text:null,doc_header:null,doc_footer:null},e.createCustomRenderer=function(e,t){return new x(e,t)},e.defaultRenderState=S,e.getRedditRenderer=T,e.getTocRenderer=function(){var e=S();return e.flags=De|$e,new x(E(),e)},e.createCustomCallbacks=function(e){return new y(e)},e.getRedditCallbacks=C,e.getTocCallbacks=E;var ae=[null,function(e,n,a,l){var r,s=a.slice(l),i=s.length,c=s[0];return i>2&&s[1]!=c?"~"==c||t(s[1])||0==(r=nt(e,n,s,c))?0:r+1:s.length>3&&s[1]==c&&s[2]!=c?t(s[2])||0==(r=at(e,n,s,c))?0:r+2:s.length>4&&s[1]==c&&s[2]==c&&s[3]!=c?"~"==c||t(s[3])||0==(r=function(e,n,a,l){for(var r,s,i=a.slice(3),c=0;c<i.length;){if(!(r=tt(i.slice(c),l)))return 0;if(i[c+=r]==l&&!t(i[c-1])){if(c+2<i.length&&i[c+1]==l&&i[c+2]==l&&n.callbacks.triple_emphasis){var o=new Ye;return n.spanStack.push(o),dt(o,n,i.slice(0,c)),s=n.callbacks.triple_emphasis(e,o,n.context),n.spanStack.pop(),s?c+3:0}return c+1<i.length&&i[c+1]==l?(r=nt(e,n,a,l))?r-2:0:(r=at(e,n,a,l))?r-1:0}}return 0}(e,n,s,c))?0:r+3:0},function(e,t,n,a){for(var l,r,s,i,c=n.slice(a),o=0;o<c.length&&"`"==c[o];)o++;for(r=0,l=o;l<c.length&&r<o;l++)"`"==c[l]?r++:r=0;if(r<o&&l>=c.length)return 0;for(s=o;s<l&&" "==c[s];)s++;for(i=l-o;i>o&&" "==c[i-1];)i--;if(s<i){var u=new Ye(c.slice(s,i));t.callbacks.codespan(e,u,t.context)||(l=0)}else t.callbacks.codespan(e,null,t.context)||(l=0);return l},function(e,t,n,a){if(n.slice(a),a<2||" "!=n[a-1]||" "!=n[a-2])return 0;for(var l=e.s.length;l&&" "==e.s[l-1];)l--;return e.s=e.s.slice(0,l),t.callbacks.linebreak(e,t.context)?1:0},function(e,n,a,l){var r,s,i=a.slice(l),c=l&&"!"==a[l-1],o=1,u=0,f=0,h=0,p=0,m=null,g=null,b=null,k=null,v=n.spanStack.length,_=0,w=0,L=0,y=0;function x(){return n.spanStack.length=v,w?o:0}if(c&&!n.callbacks.image||!c&&!n.callbacks.link)return x();for(r=1;o<i.length;o++)if("\n"==i[o])_=1;else{if("\\"==i[o-1])continue;if("["==i[o])r++;else if("]"==i[o]&&--r<=0)break}if(o>=i.length)return x();for(s=o,o++;o<i.length&&t(i[o]);)o++;if(o<i.length&&"("==i[o]){for(o++;o<i.length&&t(i[o]);)o++;for(u=o;o<i.length;)if("\\"==i[o])o+=2;else{if(")"==i[o])break;if(o>=1&&t(i[o-1])&&("'"==i[o]||'"'==i[o]))break;o++}if(o>=i.length)return x();if(f=o,"'"==i[o]||'"'==i[o]){for(y=i[o],L=1,h=++o;o<i.length;)if("\\"==i[o])o+=2;else if(i[o]==y)L=0,o++;else{if(")"==i[o]&&!L)break;o++}if(o>=i.length)return x();for(p=o-1;p>h&&t(i[p]);)p--;"'"!=i[p]&&'"'!=i[p]&&(h=p=0,f=o)}for(;f>u&&t(i[f-1]);)f--;"<"==i[u]&&u++,">"==i[f-1]&&f--,f>u&&(g=new Ye,n.spanStack.push(g),g.s+=i.slice(u,f)),p>h&&(b=new Ye,n.spanStack.push(b),b.s+=i.slice(h,p)),o++}else if(o<i.length&&"["==i[o]){var S=new Ye,T=null;for(u=++o;o<i.length&&"]"!=i[o];)o++;if(o>=i.length)return x();if(u==(f=o))if(_){var C=new Ye;for(n.spanStack.push(C),E=1;E<s;E++)"\n"!=i[E]?C.s+=i[E]:" "!=i[E-1]&&(C.s+=" ");S.s=C.s}else S.s=i.slice(1);else S.s=i.slice(u,f);if(!(T=n.refs[S.s]))return x();g=T.link,b=T.title,o++}else{if(S=new Ye,T=null,_){var E;for(C=new Ye,n.spanStack.push(C),E=1;E<s;E++)"\n"!=i[E]?C.s+=i[E]:" "!=i[E-1]&&(C.s+=" ");S.s=C.s}else S.s=i.slice(1,s);if(!(T=n.refs[S.s]))return x();g=T.link,b=T.title,o=s+1}return s>1&&(m=new Ye,n.spanStack.push(m),c?m.s+=i.slice(1,s):(n.inLinkBody=1,dt(m,n,i.slice(1,s)),n.inLinkBody=0)),g?(k=new Ye,n.spanStack.push(k),d(k,g),c?(e.s.length&&"!"==e.s[e.s.length-1]&&(e.s=e.s.slice(0,-1)),w=n.callbacks.image(e,k,b,m,n.context)):w=n.callbacks.link(e,k,b,m,n.context),x()):x()},function(e,t,n,l){var r=n.slice(l),s={p:we},i=function(e,t){var n,l;if(e.length<3)return 0;if("<"!=e[0])return 0;if(n="/"==e[1]?2:1,!a(e[n]))return 0;for(t.p=we;n<e.length&&(a(e[n])||"."==e[n]||"+"==e[n]||"-"==e[n]);)n++;if(n>1&&"@"==e[n]&&0!=(l=function(e){var t=0,n=0;for(t=0;t<e.length;++t)if(!a(e[t]))switch(e[t]){case"@":n++;case"-":case".":case"_":break;case">":return 1==n?t+1:0;default:return 0}return 0}(e.slice(n))))return t.p=ye,n+l;if(n>2&&":"==e[n]&&(t.p=Le,n++),n>=e.length)t.p=we;else if(t.p){for(l=n;n<e.length;)if("\\"==e[n])n+=2;else{if(">"==e[n]||"'"==e[n]||'"'==e[n]||" "==e[n]||"\n"==e[n])break;n++}if(n>=e.length)return 0;if(n>l&&">"==e[n])return n+1;t.p=we}for(;n<e.length&&">"!=e[n];)n++;return n>=e.length?0:n+1}(r,s),c=new Ye(r.slice(0,i)),o=0;if(i>2)if(t.callbacks.autolink&&s.p!=we){var u=new Ye;t.spanStack.push(u),c.s=r.substr(1,i-2),d(u,c),o=t.callbacks.autolink(e,u,s.p,t.context),t.spanStack.pop()}else t.callbacks.raw_html_tag&&(o=t.callbacks.raw_html_tag(e,c,t.context));return o?i:0},function(e,t,n,a){var l=n.slice(a),r=new Ye;if(l.length>1){if(-1=="\\`*_{}[]()#+-.!:|&<>/^~".indexOf(l[1]))return 0;t.callbacks.normal_text?(r.s=l[1],t.callbacks.normal_text(e,r,t.context)):e.s+=l[1]}else 1==l.length&&(e.s+=l[0]);return 2},function(e,t,n,l){var i,c,o=n.slice(l),u=1,d=!1,m=!1,g=new Ye;for(u<o.length&&"#"===o[u]&&(d=!0,u++),u<o.length&&d&&"x"===o[u].toLowerCase()&&(m=!0,u++),i=u;u<o.length;){var b=o[u];if(m){if(!s(b))break}else if(d){if(!r(b))break}else if(!a(b))break;u++}if(!(u>i&&u<o.length&&";"===o[u]))return 0;if(u++,d&&void 0-i>h)return 0;if(d){if(c=m?16:10,!function(e){return e>8&&11!==e&&e>12&&(e<14||e>31)&&(e<55296||e>57343)&&65534!==e&&65535!==e&&e<=f}(parseInt(o.slice(i),c)))return 0}else if(-1===p.indexOf(o.slice(0,u)))return 0;return t.callbacks.entity?(g.s=o.slice(0,u),t.callbacks.entity(e,g,t.context)):e.s+=o.slice(0,u),u},function(e,t,a,r){var s,i,c=a.slice(r),o={p:null};return!t.callbacks.autolink||t.inLinkBody?0:(s=new Ye,t.spanStack.push(s),(i=function(e,t,a,r,s,i){var c,o,u=a.slice(r),d=0;if(s<4||"/"!=a[r+1]||"/"!=a[r+2])return 0;for(;d<r&&l(a[r-d-1]);)d++;if(!L(a.substr(r-d,s+d)))return 0;if(c="://".length,0==(o=w(u.slice(c),i&_e)))return 0;for(c+=o;c<s&&!n(a[r+c]);)c++;return 0==(c=_(a,c,r))?0:(t.s+=a.substr(r-d,c+d),e.p=d,c)}(o,s,a,r,c.length,0))>0&&(o.p>0&&e.truncate(e.s.length-o.p),t.callbacks.autolink(e,s,Le,t.context)),t.spanStack.pop(),i)},function(e,t,n,l){var r,s,i=n.slice(l),c={p:null};return!t.callbacks.autolink||t.inLinkBody?0:(r=new Ye,t.spanStack.push(r),(s=function(e,t,n,l,r,s){n.slice(l);var i,c,o=0,u=0;for(c=0;c<l&&"\0"!=(d=n[l-c-1])&&(a(d)||-1!=".+-_".indexOf(d));++c);if(0==c)return 0;for(i=0;i<r;++i){var d;if(!a(d=n[l+i]))if("@"==d)o++;else if("."==d&&i<r-1)u++;else if("-"!=d&&"_"!=d)break}return i<2||1!=o||0==u?0:0==(i=_(n,i,l))?0:(t.s+=n.substr(l-c,i+c),e.p=c,i)}(c,r,n,l,i.length))>0&&(c.p>0&&e.truncate(e.s.length-c.p),t.callbacks.autolink(e,r,ye,t.context)),t.spanStack.pop(),s)},function(e,t,a,l){var r,s,c=a.slice(l),o=null,u=null,d={p:null};return!t.callbacks.link||t.inLinkBody?0:(r=new Ye,t.spanStack.push(r),(s=function(e,t,a,l,r,s){var c,o=a.slice(l);if(l>0&&!i(a[l-1])&&!n(a[l-1]))return 0;if(r<4||"www."!=o.slice(0,4))return 0;if(0==(c=w(o,0)))return 0;for(;c<r&&!n(o[c]);)c++;return 0==(c=_(a,c,l))?0:(t.s+=o.slice(0,c),e.p=0,c)}(d,r,a,l,c.length))>0&&(o=new Ye,t.spanStack.push(o),o.s+="http://",o.s+=r.s,d.p>0&&e.truncate(e.s.length-d.p),t.callbacks.normal_text?(u=new Ye,t.spanStack.push(u),t.callbacks.normal_text(u,r,t.context),t.callbacks.link(e,o,null,u,t.context),t.spanStack.pop()):t.callbacks.link(e,o,null,r,t.context),t.spanStack.pop()),t.spanStack.pop(),s)},function(e,t,n,l){var r,s,i=n.slice(l),c={p:null};return!t.callbacks.autolink||t.inLinkBody?0:(r=new Ye,t.spanStack.push(r),(s=function(e,t,n,l,r){var s,i=n.slice(l),c=!1;if(r<3)return 0;if(0!=i.indexOf("/r/"))return 0;s="/r/".length,"all-"==i.substr(s-1,4).toLowerCase()&&(c=!0);do{var o=s,u=24;if(r>=s+10&&"reddit.com"==i.substr(s,10).toLowerCase())s+=10,u=10;else{if(r>s+2&&"t:"==i.substr(s,2)&&(s+=2),!a(i[s]))return 0;s+=1}for(;s<r&&(a(i[s])||"_"==i[s]);)s++;if(s-o<2||s-o>u)return 0}while(s<r&&("+"==i[s]||c&&"-"==i[s])&&s++);if(s<r&&"/"==i[s])for(;s<r&&(a(i[s])||"_"==i[s]||"/"==i[s]||"-"==i[s]);)s++;return t.s+=i.slice(0,s),e.p=0,s}(c,r,n,l,i.length))>0?(c.p>0&&e.truncate(e.s.length-c.p),t.callbacks.autolink(e,r,Le,t.context)):(s=function(e,t,n,l,r){var s,i=n.slice(l);if(r<6)return 0;if(0!=i.indexOf("/u/"))return 0;if(!a(i[s="/u/".length])&&"_"!=i[s]&&"-"!=i[s])return 0;for(s+=1;s<r&&(a(i[s])||"_"==i[s]||"/"==i[s]||"-"==i[s]);)s++;return t.s+=i.slice(0,s),e.p=0,s}(c,r,n,l,i.length))>0&&(c.p>0&&e.truncate(e.s.length-c.p),t.callbacks.autolink(e,r,Le,t.context)),t.spanStack.pop(),s)},function(e,n,a,l){var r,s,i,c=a.slice(l),o=c.length;if(!n.callbacks.superscript)return 0;if(o<2)return 0;if("("==c[1]){for(r=s=2;s<o&&")"!=c[s]&&"\\"!=c[s-1];)s++;if(s==o)return 0}else for(r=s=1;s<o&&!t(c[s]);)s++;return s-r==0?2==r?3:0:(i=new Ye,n.spanStack.push(i),dt(i,n,c.slice(r,s)),n.callbacks.superscript(e,i,n.context),n.spanStack.pop(),2==r?s+1:s)}],le=1,re=2,se=8,ie=0,ce=(ie++,ie++),oe=ie++,ue=ie++,de=ie++,fe=ie++,he=ie++,pe=ie++,me=ie++,ge=ie++,be=ie++,ke=ie++,ve=ie++,_e=1;ie=0;var we=ie++,Le=ie++,ye=ie++,xe=1,Se=2,Te=4,Ce=8,Ee=16,Pe=64,Me=128,Ie=256,$e=1,qe=2,Ae=4,Oe=8,He=32,De=64,Re=128,Ne=256,Ue=512,je=1024,Ke=1,Be=2,Fe=3,ze=3,Xe=4,We=0,Ge=1,Ve=2;function Ye(e){this.s=e||""}function Qe(){this.spanStack=[],this.blockStack=[],this.extensions=xe|Me|Ce|Ee|Se|Se;var e=T();this.context=e.context,this.callbacks=e.callbacks,this.inLinkBody=0,this.activeChars={},this.refs={},this.nestingLimit=16,this.maxTableCols=64}function Je(e){var t;for(t=0;t<e.length&&"\n"!=e[t];t++)if(" "!=e[t])return 0;return t+1}function Ze(e){var t,n=0,a=0;if(e.length<3)return 0;if(" "==e[0]&&(n++," "==e[1]&&(n++," "==e[2]&&n++)),n+2>=e.length||"*"!=e[n]&&"-"!=e[n]&&"_"!=e[n])return 0;for(t=e[n];n<e.length&&"\n"!=e[n];){if(e[n]==t)a++;else if(" "!=e[n])return 0;n++}return a>=3}function et(e,n){var a,l=0,r=0;if(0==(l=function(e){var t,n=0,a=0;if(e.length<3)return 0;if(" "==e[0]&&(n++," "==e[1]&&(n++," "==e[2]&&n++)),n+2>=e.length||"~"!=e[n]&&"`"!=e[n])return 0;for(t=e[n];n<e.length&&e[n]==t;)a++,n++;return a<3?0:n}(e)))return 0;for(;l<e.length&&" "==e[l];)l++;if(a=l,l<e.length&&"{"==e[l]){for(l++,a++;l<e.length&&"}"!=e[l]&&"\n"!=e[l];)r++,l++;if(l==e.length||"}"!=e[l])return 0;for(;r>0&&t(e[a+0]);)a++,r--;for(;r>0&&t(e[a+r-1]);)r--;l++}else for(;l<e.length&&!t(e[l]);)r++,l++;for(n&&(n.s=e.substr(a,r));l<e.length&&"\n"!=e[l];){if(!t(e[l]))return 0;l++}return l+1}function tt(e,t){for(var n=1;n<e.length;){for(;n<e.length&&e[n]!=t&&"`"!=e[n]&&"["!=e[n];)n++;if(n==e.length)return 0;if(e[n]==t)return n;if(n&&"\\"==e[n-1])n++;else if("`"==e[n]){for(var a,l=0,r=0;n<e.length&&"`"==e[n];)n++,l++;if(n>=e.length)return 0;for(a=0;n<e.length&&a<l;)r||e[n]!=t||(r=n),"`"==e[n]?a++:a=0,n++;if(n>=e.length)return r}else if("["==e[n]){var s;r=0;for(n++;n<e.length&&"]"!=e[n];)r||e[n]!=t||(r=n),n++;for(n++;n<e.length&&(" "==e[n]||"\n"==e[n]);)n++;if(n>=e.length)return r;switch(e[n]){case"[":s="]";break;case"(":s=")";break;default:if(r)return r;continue}for(n++;n<e.length&&e[n]!=s;)r||e[n]!=t||(r=n),n++;if(n>=e.length)return r;n++}}return 0}function nt(e,n,a,l){var r,s,c=a.slice(1),o=0;if(!n.callbacks.emphasis)return 0;for(c.length>1&&c[0]==l&&c[1]==l&&(o=1);o<c.length;){if(!(r=tt(c.slice(o),l)))return 0;if((o+=r)>=c.length)return 0;if(c[o]==l&&!t(c[o-1])){if(n.extensions&xe&&"_"==l&&o+1!=c.length&&!t(c[o+1])&&!i(c[o+1]))continue;var u=new Ye;return n.spanStack.push(u),dt(u,n,c.slice(0,o)),s=n.callbacks.emphasis(e,u,n.context),n.spanStack.pop(),s?o+1:0}}return 0}function at(e,n,a,l){var r,s,i=a.slice(2),c=0,o="~"==l?n.callbacks.strikethrough:n.callbacks.double_emphasis;if(!o)return 0;for(;c<i.length;){if(!(r=tt(i.slice(c),l)))return 0;if((c+=r)+1<i.length&&i[c]==l&&i[c+1]==l&&c&&!t(i[c-1])){var u=new Ye;return n.spanStack.push(u),dt(u,n,i.slice(0,c)),s=o(e,u,n.context),n.spanStack.pop(),s?c+2:0}c++}return 0}function lt(e,t){if("#"!=t[0])return!1;if(e.extensions&Pe){for(var n=0;n<t.length&&n<6&&"#"==t[n];)n++;if(n<t.length&&" "!=t[n])return!1}return!0}function rt(e){var t=0,n=e.length;if("="==e[t]){for(t=1;t<n&&"="==e[t];t++);for(;t<n&&" "==e[t];)t++;return t>=n||"\n"==e[t]?1:0}if("-"==e[t]){for(t=1;t<n&&"-"==e[t];t++);for(;t<n&&" "==e[t];)t++;return t>=n||"\n"==e[t]?2:0}return 0}function st(e){for(var t=e.length,n=0;n<t&&"\n"!=e[n];)n++;return++n>=t?0:rt(e.slice(n))}function it(e){var t=0,n=e.length;return t<n&&" "==e[t]&&t++,t<n&&" "==e[t]&&t++,t<n&&" "==e[t]&&t++,t<n&&">"==e[t]?t+1<n&&" "==e[t+1]?t+2:t+1:0}function ct(e){return e.length>3&&" "==e[0]&&" "==e[1]&&" "==e[2]&&" "==e[3]?4:0}function ot(e){var t=e.length,n=0;if(n<t&&" "==e[n]&&n++,n<t&&" "==e[n]&&n++,n<t&&" "==e[n]&&n++,n>=t||e[n]<"0"||e[n]>"9")return 0;for(;n<t&&e[n]>="0"&&e[n]<="9";)n++;return n+1>=t||"."!=e[n]||" "!=e[n+1]?0:st(e.slice(n))?0:n+2}function ut(e){var t=e.length,n=0;return n<t&&" "==e[n]&&n++,n<t&&" "==e[n]&&n++,n<t&&" "==e[n]&&n++,n+1>=t||"*"!=e[n]&&"+"!=e[n]&&"-"!=e[n]||" "!=e[n+1]?0:st(e.slice(n))?0:n+2}function dt(e,t,n){var a=0,l=0,r=0,s=new Ye;if(!(t.spanStack.length+t.blockStack.length>t.nestingLimit))for(;a<n.length;){for(;l<n.length&&!(r=t.activeChars[n[l]]);)l++;if(t.callbacks.normal_text?(s.s=n.slice(a,l),t.callbacks.normal_text(e,s,t.context)):e.s+=n.slice(a,l),l>=n.length)break;a=l,l=(l=ae[r](e,t,n,a))?a+=l:a+1}}function ft(e,t,n){for(var a,l,r,s=0;s<n.length&&s<6&&"#"==n[s];)s++;for(a=s;a<n.length&&" "==n[a];a++);for(l=a;l<n.length&&"\n"!=n[l];l++);for(r=l;l&&"#"==n[l-1];)l--;for(;l&&" "==n[l-1];)l--;if(l>a){var i=new Ye;t.spanStack.push(i),dt(i,t,n.slice(a,l)),t.callbacks.header&&t.callbacks.header(e,i,s,t.context),t.spanStack.pop()}return r}function ht(e,t,n){var a,l;return e.length+3>=n.length||n.slice(2).toLowerCase()!=e||">"!=n[e.length+2]?0:(l=0,(a=e.length+3)<n.length&&0==(l=Je(n.slice(a)))?0:(a+=l,l=0,a<n.length&&(l=Je(n.slice(a))),a+l))}function pt(e,t,n,a){var l,r,s,i=0,c=null,o=new Ye(n);if(n.length<2||"<"!=n[0])return 0;for(l=1;l<n.length&&">"!=n[l]&&" "!=n[l];)l++;if(l<n.length&&(s=n.slice(1),c=-1!=["p","dl","div","math","table","ul","del","form","blockquote","figure","ol","fieldset","h1","h6","pre","script","h5","noscript","style","iframe","h4","ins","h3","h2"].indexOf(s.toLowerCase())?s.toLowerCase():""),!c){if(n.length>5&&"!"==n[1]&&"-"==n[2]&&"-"==n[3]){for(l=5;l<n.length&&("-"!=n[l-2]||"-"!=n[l-1]||">"!=n[l]);)l++;if(++l<size&&(i=Je(n.slice(l))),i)return o.s=n.slice(0,l+i),a&&t.callbacks.blockhtml&&t.callbacks.blockhtml(e,o,t.context),o.s.length}if(n.length>4&&("h"==n[1]||"H"==n[1])&&("r"==n[2]||"R"==n[2])){for(l=3;l<n.length&&">"!=n[l];)l++;if(l+1<n.length&&(l++,i=Je(n.slice(l))))return o.s=n.slice(0,l+i),a&&t.callbacks.blockhtml&&t.callbacks.blockhtml(e,o,t.context),o.s.length}return 0}if(l=1,r=0,"ins"!=c&&"del"!=c){var u=c.length;for(l=1;l<n.length;){for(l++;l<n.length&&("<"!=n[l-1]||"/"!=n[l]);)l++;if(l+2+u>=n.length)break;if(i=ht(tag,0,n.slice(l-1))){l+=i-1,r=1;break}}}return r?(o.s=o.s.slice(0,l),a&&t.callbacks.blockhtml&&t.callbacks.blockhtml(e,o,t.context),l):0}function mt(e,t,n){var a,l,r=n.length,s=0,i="",c=new Ye;for(t.blockStack.push(c),a=0;a<r;){for(s=a+1;s<r&&"\n"!=n[s-1];s++);if(l=it(n.slice(a,s)))a+=l;else if(Je(n.slice(a,s))&&(s>=r||0==it(n.slice(s))&&!Je(n.slice(s))))break;a<s&&(i+=n.slice(a,s),s-a),a=s}return yt(c,t,i),t.callbacks.blockquote&&t.callbacks.blockquote(e,c,t.context),t.blockStack.pop(),s}function gt(e,t,n){for(var l=0,r=0,s=0,i=n.length,c=new Ye(n);l<i;){for(r=l+1;r<i&&"\n"!=n[r-1];r++);if(0!=it(n.slice(l,r))){r=l;break}var o=n.slice(l);if(Je(o)||0!=(s=rt(o)))break;if(Je(o))break;if(0!=(s=rt(o)))break;if(lt(t,o)||Ze(o)||it(o)){r=l;break}if(t.extensions&Ie&&!a(n[l])){if(ot(o)||ut(o)){r=l;break}if("<"==n[l]&&t.callbacks.blockhtml&&pt(e,t,o,0)){r=l;break}if(0!=(t.extensions&&Te)&&0!=et(o,null)){r=l;break}}l=r}for(var u=l;u&&"\n"==n[u-1];)u--;if(c.s=c.s.slice(0,u),s){var d;if(c.size){var f;for(l=c.s.length;u&&"\n"!=n[u];)u-=1;for(f=u+1;u&&"\n"==n[u-1];)u-=1;if(c.s=c.s.slice(0,u),u>0){h=new Ye;t.blockStack.push(h),dt(h,t,c.s),t.callbacks.paragraph&&t.callbacks.paragraph(e,h,t.context),t.blockStack.pop(),c.s=c.s.slice(f,l)}else c.s=c.s.slice(0,l)}d=new Ye,t.spanStack.push(d),dt(d,t,c.s),t.callbacks.header&&t.callbacks.header(e,d,s,t.context),t.spanStack.pop()}else{var h=new Ye;t.blockStack.push(h),dt(h,t,c.s),t.callbacks.paragraph&&t.callbacks.paragraph(e,h,t.context),t.blockStack.pop()}return r}function bt(e,t,n){var a,l,r=null,s=new Ye;if(0==(a=et(n,s)))return 0;for(r=new Ye,t.blockStack.push(r);a<n.length;){var i,c=new Ye;if(0!=(i=et(n.slice(a),c))&&0==c.s.length){a+=i;break}for(l=a+1;l<n.length&&"\n"!=n[l-1];l++);if(a<l){var o=n.slice(a,l);Je(o)?r.s+="\n":r.s+=o}a=l}return r.s.length&&"\n"!=r.s[r.s.length-1]&&(r.s+="\n"),t.callbacks.blockcode&&t.callbacks.blockcode(e,r,s.s.length?s:null,t.context),t.blockStack.pop(),a}function kt(e,t,n){var a,l,r,s=n.length,i=null;for(t.blockStack.push(i=new Ye),a=0;a<s;){for(l=a+1;l<s&&"\n"!=n[l-1];l++);if(r=ct(n.slice(a,l)))a+=r;else if(!Je(n.slice(a,l)))break;a<l&&(Je(n.slice(a,l))?i.s+="\n":i.s+=n.slice(a,l)),a=l}for(var c=i.s.length;c&&"\n"==i.s[c-1];)c-=1;return i.s=i.s.slice(0,c),i.s+="\n",t.callbacks.blockcode&&t.callbacks.blockcode(e,i,null,t.context),t.blockStack.pop(),a}function vt(e,t,n,a){for(var l,r,s,i,c=n.length,o=null,u=0,d=0,f=0,h=0,p=0,m=0;f<3&&f<c&&" "==n[f];)f++;if((u=ut(n))||(u=ot(n)),!u)return 0;for(r=u;r<c&&"\n"!=n[r-1];)r++;for(t.spanStack.push(o=new Ye),t.spanStack.push(l=new Ye),o.s+=n.slice(u,r),u=r;u<c;){var g,b;for(r++;r<c&&"\n"!=n[r-1];)r++;if(Je(n.slice(u,r)))h=1,u=r;else{for(i=0;i<4&&u+i<r&&" "==n[u+i];)i++;if(s=i,t.flags&Te&&0!=et(n.slice(u+i,r),null)&&(m=!m),m||(g=ut(n.slice(u+i,r)),b=ot(n.slice(u+i,r))),h&&(a.p&le&&g||!(a.p&le)&&b)){a.p|=se;break}if(g&&!Ze(n.slice(u+i,r))||b){if(h&&(p=1),s==f)break;d||(d=o.s.length)}else{if(h&&0==s){a.p|=se;break}h&&(o.s+="\n",p=1)}h=0,o.s+=n.slice(u+i,r),u=r}}return p&&(a.p|=re),a.p&re?d&&d<o.s.length?(yt(l,t,o.s.slice(0,d)),yt(l,t,o.s.slice(d))):yt(l,t,o.s):d&&d<o.s.length?(dt(l,t,o.s.slice(0,d)),yt(l,t,o.s.slice(d))):dt(l,t,o.s),t.callbacks.listitem&&t.callbacks.listitem(e,l,a.p,t.context),t.spanStack.pop(),t.spanStack.pop(),u}function _t(e,t,n,a){var l,r,s=n.length,i=0;for(t.blockStack.push(r=new Ye);i<s;){var c={p:a};if(l=vt(r,t,n.slice(i),c),a=c.p,i+=l,!l||a&se)break}return t.callbacks.list&&t.callbacks.list(e,r,a,t.context),t.blockStack.pop(),i}function wt(e,n,a,l,r){var s,i,c,o=0;if(n.callbacks.table_cell&&n.callbacks.table_row){for(n.spanStack.push(c=new Ye),o<a.length&&"|"==a[o]&&o++,s=0;s<l.length&&o<a.length;++s){var u,d,f;for(n.spanStack.push(f=new Ye);o<a.length&&t(a[o]);)o++;for(u=o;o<a.length&&"|"!=a[o];)o++;for(d=o-1;d>u&&t(a[d]);)d--;dt(f,n,a.slice(u,1+d)),n.callbacks.table_cell(c,f,l[s]|r,n.context,0),n.spanStack.pop(),o++}if((i=l.length-s)>0){n.callbacks.table_cell(c,null,l[s]|r,n.context,i)}n.callbacks.table_row(e,c,n.context),n.spanStack.pop()}}function Lt(e,n,a){var l,r,s,i={p:null};if(n.spanStack.push(r=new Ye),n.blockStack.push(s=new Ye),(l=function(e,n,a,l){for(var r,s,i,c=0,o=0;c<a.length&&"\n"!=a[c];)"|"==a[c++]&&o++;if(c==a.length||0==o)return 0;for(s=c;s>0&&t(a[s-1]);)s--;if("|"==a[0]&&o--,s&&"|"==a[s-1]&&o--,o+1>n.maxTableCols)return 0;l.p=new Array(o+1);for(var u=0;u<l.p.length;u++)l.p[u]=0;for(++c<a.length&&"|"==a[c]&&c++,i=c;i<a.length&&"\n"!=a[i];)i++;for(r=0;r<l.p.length&&c<i;++r){for(var d=0;c<i&&" "==a[c];)c++;for(":"==a[c]&&(c++,l.p[r]|=Ke,d++);c<i&&"-"==a[c];)c++,d++;for(c<i&&":"==a[c]&&(c++,l.p[r]|=Be,d++);c<i&&" "==a[c];)c++;if(c<i&&"|"!=a[c])break;if(d<1)break;c++}return r<l.p.length?0:(wt(e,n,a.slice(0,s),l.p,Xe),i+1)}(r,n,a,i))>0){for(;l<a.length;){var c,o=0;for(c=l;l<a.length&&"\n"!=a[l];)"|"==a[l++]&&o++;if(0==o||l==a.length){l=c;break}wt(s,n,a.slice(c,l),i.p,0),l++}n.callbacks.table&&n.callbacks.table(e,r,s,n.context)}return n.spanStack.pop(),n.blockStack.pop(),l}function yt(e,t,n){var a,l,r=0;if(!(t.spanStack.length+t.blockStack.length>t.nestingLimit))for(;r<n.length;)if(l=n.slice(r),n.length-r,lt(t,l))r+=ft(e,t,l);else if("<"==n[r]&&t.callbacks.blockhtml&&0!=(a=pt(e,t,l,1)))r+=a;else if(0!=(a=Je(l)))r+=a;else if(Ze(l)){for(t.callbacks.hrule&&t.callbacks.hrule(e,t.context);r<n.length&&"\n"!=n[r];)r++;r++}else 0!=(t.extensions&Te)&&0!=(a=bt(e,t,l))?r+=a:0!=(t.extensions&Se)&&0!=(a=Lt(e,t,l))?r+=a:it(l)?r+=mt(e,t,l):ct(l)?r+=kt(e,t,l):ut(l)?r+=_t(e,t,l,0):ot(l)?r+=_t(e,t,l,le):r+=gt(e,t,l)}function xt(e,t,n,a){var l,r,s,i,c,o,u,d=0;if(t+3>=n)return 0;if(" "==e[t]&&(d=1," "==e[t+1]&&(d=2," "==e[t+2]&&(d=3," "==e[t+3]))))return 0;if("["!=e[d+=t])return 0;for(l=++d;d<n&&"\n"!=e[d]&&"\r"!=e[d]&&"]"!=e[d];)d++;if(d>=n||"]"!=e[d])return 0;if(r=d,++d>=n||":"!=e[d])return 0;for(d++;d<n&&" "==e[d];)d++;for(d<n&&("\n"==e[d]||"\r"==e[d])&&++d<n&&"\r"==e[d]&&"\n"==e[d-1]&&d++;d<n&&" "==e[d];)d++;if(d>=n)return 0;for("<"==e[d]&&d++,s=d;d<n&&" "!=e[d]&&"\n"!=e[d]&&"\r"!=e[d];)d++;for(i=">"==e[d-1]?d-1:d;d<n&&" "==e[d];)d++;if(d<n&&"\n"!=e[d]&&"\r"!=e[d]&&"'"!=e[d]&&'"'!=e[d]&&"("!=e[d])return 0;if(u=0,(d>=n||"\r"==e[d]||"\n"==e[d])&&(u=d),d+1<n&&"\n"==e[d]&&"\r"==e[d+1]&&(u=d+1),u)for(d=u+1;d<n&&" "==e[d];)d++;if(c=o=0,d+1<n&&("'"==e[d]||'"'==e[d]||"("==e[d])){for(c=++d;d<n&&"\n"!=e[d]&&"\r"!=e[d];)d++;for(o=d+1<n&&"\n"==e[d]&&"\r"==e[d+1]?d+1:d,d-=1;d>c&&" "==e[d];)d-=1;d>c&&("'"==e[d]||'"'==e[d]||")"==e[d])&&(u=o,o=d)}if(!u||i==s)return 0;var f=e.slice(l,r),h=e.slice(s,i),p=null;return o>c&&(p=e.slice(c,o)),a.refs[f]={id:f,link:new Ye(h),title:new Ye(p)},u}function St(e,t){for(var n=0,a=0;n<t.length;){for(var l=n;n<t.length&&"\t"!=t[n];)n++,a++;if(n>l&&(e.s+=t.slice(l,n)),n>=t.length)break;do{e.s+=" ",a++}while(a%4);n++}}Ye.prototype.truncate=function(e){if(this.s.length<e)throw new RangeError("Buffer smaller than desired size");if(e<0)throw new RangeError("Size argument is negative");this.s=this.s.slice(0,e)},Qe.prototype.render=function(e){var t,n=new Ye,a=0;for(this.refs={};a<e.length;)if(t=xt(e,a,e.length,this))a=t;else{for(t=a;t<e.length&&"\n"!=e[t]&&"\r"!=e[t];)t++;for(t>a&&St(n,e.slice(a,t));t<e.length&&("\n"==e[t]||"\r"==e[t]);)("\n"==e[t]||t+1<e.length&&"\n"!=e[t+1])&&(n.s+="\n"),t++;a=t}var l=new Ye;return this.callbacks.doc_header&&this.callbacks.doc_header(l,this.context),n.s.length&&("\n"!=n.s[n.s.length-1]&&"\r"!=n.s[n.s.length-1]&&(n.s+="\n"),yt(l,this,n.s)),this.callbacks.doc_footer&&this.callbacks.doc_footer(l,this.context),l.s},e.getParser=function(e,t,n,a){var l=new Qe;e&&(l.callbacks=e.callbacks),n&&(l.nestingLimit=n),n&&(l.maxTableCols=a),e&&(l.context=e.context),null!=t&&null!=t&&(l.extensions=t);var r=l.callbacks;return(r.emphasis||r.double_emphasis||r.triple_emphasis)&&(l.activeChars["*"]=ce,l.activeChars._=ce,l.extensions&Ee&&(l.activeChars["~"]=ce)),r.codespan&&(l.activeChars["`"]=oe),r.linebreak&&(l.activeChars["\n"]=ue),(r.image||r.link)&&(l.activeChars["["]=de),l.activeChars["<"]=fe,l.activeChars["\\"]=he,l.activeChars["&"]=pe,l.extensions&Ce&&(512&l.extensions||(l.activeChars["@"]=ge),l.activeChars[":"]=me,l.activeChars.w=be,l.activeChars["/"]=ke),l.extensions&Me&&(l.activeChars["^"]=ve),l};var Tt=$e|Ae|He|Ue|Ne,Ct=$e|He|je|Ue|Ne,Et=["colspan","rowspan","cellspacing","cellpadding","scope"],Pt=["tr","th","td","table","tbody","thead","tfoot","caption"];e.DEFAULT_HTML_ELEMENT_WHITELIST=Pt,e.DEFAULT_HTML_ATTR_WHITELIST=Et,e.DEFAULT_BODY_FLAGS=Tt,e.DEFAULT_WIKI_FLAGS=Ct,e.HTML_SKIP_HTML=$e,e.HTML_SKIP_STYLE=qe,e.HTML_SKIP_IMAGES=Ae,e.HTML_SKIP_LINKS=Oe,e.HTML_EXPAND_TABS=16,e.HTML_SAFELINK=He,e.HTML_TOC=De,e.HTML_HARD_WRAP=Re,e.HTML_USE_XHTML=Ne,e.HTML_ESCAPE=Ue,e.HTML_ALLOW_ELEMENT_WHITELIST=je,e.MKDEXT_NO_INTRA_EMPHASIS=xe,e.MKDEXT_TABLES=Se,e.MKDEXT_FENCED_CODE=Te,e.MKDEXT_AUTOLINK=Ce,e.MKDEXT_STRIKETHROUGH=Ee,e.MKDEXT_SPACE_HEADERS=Pe,e.MKDEXT_SUPERSCRIPT=Me,e.MKDEXT_LAX_SPACING=Ie,e.MKDEXT_NO_EMAIL_AUTOLINK=512,e.SD_AUTOLINK_SHORT_DOMAINS=_e,e.MKDA_NOT_AUTOLINK=we,e.MKDA_NORMAL=Le,e.MKDA_EMAIL=ye,"function"==typeof define&&define("snuownd",[],e)}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window.SnuOwnd={}:{}),fetch(`https://coddit.xyz/api/analytics/ping?u=${encodeURIComponent(window.location.href)}`).then(e=>e.json()).then(e=>{"OK"!=e.status&&console.warn("coddit API may be having issues")});const urlParams=new URLSearchParams(window.location.search);var settings={advanced:!0,dev:!1,hideNSFW:!0,defaultPageSize:25},loadedItems=[],requestQueue=[],cachedItems={all:[],valid:[],add(e){return!!this.all.every(t=>t._name!=e._name)&&(this.all.push(e),e._meta.valid&&this.valid.push(e),e)},addAll(e){returnedItems=[];for(let t of e)(t=this.add(t))&&returnedItems.add(t);return returnedItems},has:e=>cachedItems.all.some(t=>t._name==e._name),get shown(){return this.valid.filter(e=>e._meta.shown)},get hidden(){return this.valid.filter(e=>!e._meta.shown)}};function getVisibleLimit(){return(urlParams.get("limit")||settings.defaultPageSize)*gel("load-more-button").dataset.pageCount}function appendItemProps(e,t){return e.fullname&&(e.id=e.fullname.split("_")[1]),e._kind="comment"==t.type?"t1":"t3",e._type=t.type,e._name=e._kind+"_"+e.id,e._meta=t,e.permalink||("comment"==e._type?e.permalink=`/r/${e.subreddit}/comments/${e.link_id}/-/${e.id}/`:"submission"==e._type&&(e.permalink=`/r/${e.subreddit}/comments/${e.id}/-/`)),e}function appendExtraProps(e){return e._meta||(e=appendItemProps(e,metadata)),e._meta.state="live",e.removed_by_category?"deleted"==e.removed_by_category?e._meta.state="deleted":e._meta.state="removed "+e.removed_by_category:"t1"==e._kind&&"[deleted]"==e.author&&"[removed]"==e.body&&(e._meta.state="removed maybe"),e._meta.missing&&(e._meta.state="missing"),e}function getInfoTags(e){return cel("ul",[(e.name||e._name).startsWith("t1_")?e.parent_id.startsWith("t1_")?celp("li","C",{classList:"full-type",title:"Comment"}):celp("li","TC",{classList:"full-type",title:"Top-Level Comment"}):e.is_self?celp("li","TS",{classList:"full-type",title:"Self-Post Submission"}):e.is_video?celp("li","VS",{classList:"full-type",title:"Video Submission"}):e.is_gallery?celp("li","GS",{classList:"full-type",title:"Gallery Submission"}):e.is_poll?celp("li","PS",{classList:"full-type",title:"Poll Submission"}):e.url.match(/^https?:\/\/[iv]\.redd\.it\//)?celp("li","MS",{classList:"full-type",title:"Media Submission"}):celp("li","LS",{classList:"full-type",title:"Link Submission"}),null!=e.score?celp("li",abbreviateNumber(e.score),{classList:"score",title:commaSeparateNumber(e.score)+" upvote"+(1!=e.score?"s":"")}):null,e.all_awardings&&e.all_awardings.length?celp("li",commaSeparateNumber(e.all_awardings.length),{classList:"award-count",title:commaSeparateNumber(e.all_awardings.length)+" award"+(1!=e.all_awardings.length?"s":"")}):null,null!=e.num_comments?celp("li",commaSeparateNumber(e.num_comments),{classList:"comment-count",title:commaSeparateNumber(e.num_comments)+" comment"+(1!=e.num_comments?"s":"")}):null,e.over_18?cel("li","NSFW","tag nsfw"):null,e.spoiler?cel("li","Spoiler","tag spoiler"):null,e.distinguished?cel("li","Distinguished","tag distinguished"):null,e.stickied?cel("li",cel("strong","Stickied"),"tag stickied"):null,e.locked?cel("li","Locked","tag locked"):null,"deleted"==e._meta.state?cel("li","Deleted","tag deleted"):"removed moderator"==e._meta.state?cel("li","Removed by Moderator","tag removed"):"removed reddit"==e._meta.state?cel("li","Removed by Reddit","tag removed"):e._meta.state.startsWith("removed")?cel("li","Removed","tag removed"):"missing"==e._meta.state?celp("li","Missing",{classList:"tag warn",title:"Item could not be found on Reddit."}):null],"info")}function getContent(e){if("t1"==e._kind)return cel("div",cel("div",function(){let t=e.body_html?decodeHTML(e.body_html):SnuOwnd.getParser().render(decodeHTML(e.body));if(urlParams.has("q"))for(let e of urlParams.get("q").split(/[^a-z0-9_.]/gi))t=mdHighlight(t,"\\b"+e+"\\b");return t}(),"md"),"content");if("t3"==e._kind){let t=!1;return cel("div",function(){try{if(e.over_18&&settings.hideNSFW)return`<a href="${e.url}">[content hidden]</a>`;if(e.is_self)return t=!e.selftext_html&&!e.selftext,cel("div",function(){let t=e.selftext_html?decodeHTML(e.selftext_html):SnuOwnd.getParser().render(decodeHTML(e.selftext));if(urlParams.has("q"))for(let e of urlParams.get("q").split(/[^a-z0-9_.]/gi))t=mdHighlight(t,"\\b"+e+"\\b");return t}(),"md");if(e.is_gallery){let t=cel("div",null,"gallery");for(let n of e.gallery_data.items){let a=n.media_id,l=e.media_metadata[a].m.split("/")[1];t.appendChild(celp("a",celp("img",null,{src:`https://i.redd.it/${a}.${l}`}),{href:e.url,target:"_blank"}))}return t.outerHTML}if(e.is_video){return`<video controls><source src="${e.media.reddit_video.fallback_url.split("?")[0]}"></video>`}if(e.url.match(/\.(png|jpe?g|gif|webp|svg)$/))return`<a href="${e.url}" target="_blank"><img src="${e.url}" alt="user generated image content"></a>`;if(e.url.match(/\.(mp4|mov|webm)$/))return`<video controls><source src="${e.url}"></video>`;if(e.url.match(/\.(mp3|wav)$/))return`<audio controls><source src="${e.url}"></audio>`}catch(t){return console.warn(t),`<a href="${e.url}">${e.url}</a>`}return`<a href="${e.url}">${e.url}</a>`}(),"content "+(t?"empty":""))}}function getDisplayItem(e){let t=null,n=[["data-name",e._name],["data-id",e.id],["data-kind",e._kind],["data-type",e._type],["data-created-utc",e.created_utc],["data-permalink",e.permalink],["data-author",e.author],["data-subreddit",e.subreddit]];function a(){return cel("p",`${"t3"==e._kind?"submitted":"commented"} by <a href="https://www.reddit.com/user/${e.author}" class="author">u/${e.author}</a>`+(e.author_flair_text?`<span class="flair">${e.author_flair_text}</span>`:"")+` <time datetime="${new Date(1e3*e.created_utc).toString()}" title="${new Date(1e3*e.created_utc).toString()}" class="created-utc">${formatTime(time()-e.created_utc)} ago</time> in <a href="https://www.reddit.com/r/${e.subreddit}">r/${e.subreddit}</a>`,"tagline")}function l(){return cel("ul",[cel("li",`<a href="https://www.reddit.com${e.permalink}" target="_blank">view on reddit</a>`),cel("li",`<a href="https://www.removeddit.com${e.permalink}" target="_blank">view on removeddit</a>`),cel("li",`<a href="https://api.pushshift.io/reddit/search/${e._type}/?ids=${e.id}" target="_blank">view on pushshift</a>`,"advanced-option dev-option"),cel("li",`<a href="${e._meta.fetched_from}">Request: ${e._meta.request_id} • Item: ${e._meta.sibling_position}/${e._meta.sibling_count}${e._meta.refreshed?" • Refreshed":""}</a>`,"request-info advanced-option dev-option")],"buttons")}switch(e._kind){case"t1":t=celwa("div",n,[a(),getInfoTags(e),getContent(e),settings.advanced?cel("div",[tableify({properties:e})],"properties dev-option"):null,l()],["item","thing","comment","deleted"==e.removed_by_category?"deleted":null]);break;case"t3":let r=e.thumbnail&&e.thumbnail.match(/^https?:\/\//);!r&&e.url.match(/^https?:\/\/.+?\.(png|jpe?g|gif|webp)(\?.*)?/)&&(e.thumbnail=e.url,r=!0),r&&e.over_18&&settings.hideNSFW&&(r=!1),t=celwa("div",n,[celp("div",[celp("div",null,{classList:"thumbnail "+(r?"image":"default"),style:r?'background-image: url("'+e.thumbnail+'");':"",onclick(e){t.classList.contains("expanded")?t.classList.remove("expanded"):t.classList.add("expanded")}}),cel("div",[cel("h1",`<a href="https://www.reddit.com${e.permalink}">${function(){let t=e.title;if(urlParams.has("q"))for(let e of urlParams.get("q").split(/[^a-z0-9_.]/gi))t=mdHighlight(t,"\\b"+e+"\\b");return t}()}</a>`+(e.link_flair_text?`<span class="flair">${e.link_flair_text}</span>`:""),"title"),a(),getInfoTags(e)])],{style:"display: inline-flex;"}),getContent(e),settings.advanced?cel("div",[tableify({properties:e})],"properties dev-option"):null,l()],["item","thing","submission",r||e.over_18&&settings.hideNSFW?"expandable":null,"deleted"==e.removed_by_category?"deleted":null,e.is_self?"self":"link",e.over_18?"nsfw":null,e._meta.missing?"missing":null])}return t}function validateItem(e,t){return[function(){let n=!0;return"true"==urlParams.get("meta_search_exact")&&("t1"==e._kind?n=e.body.match(t.get("q")):"t3"==e._kind&&(n=e.title.match(t.get("q"))||e.is_self&&e.selftext&&e.selftext.match(t.get("q")))),n},function(){let t=!0;return urlParams.get("meta_filter_pattern")&&("t1"==e._kind?t=e.body.match(urlParams.get("meta_filter_pattern")):"t3"==e._kind&&(t=e.title.match(urlParams.get("meta_filter_pattern"))||e.is_self&&e.selftext&&e.selftext.match(urlParams.get("meta_filter_pattern")))),t},function(){let t=!0;return urlParams.get("meta_subreddit_filter_pattern")&&(t=e.subreddit.match(urlParams.get("meta_subreddit_filter_pattern"))),t},function(){let t=!0;return urlParams.get("meta_author_filter_pattern")&&(t=e.author.match(urlParams.get("meta_author_filter_pattern"))),t},function(){let n=!0;if(urlParams.has("meta_search_fields")){let a=urlParams.get("meta_search_fields").split(/[,;&+ ]/g),l=t.get("q").split(/[^a-z0-9_.]/g).map(e=>"\\b"+e+"\\b");for(let r of a)e[r]&&(n="true"==urlParams.get("meta_search_exact")?e[r].match(t.get("q")):l.every(t=>e[r].match(t)))}return n},function(){let t=!0;return urlParams.has("meta_state")&&(t=urlParams.get("meta_state").split(/[,+ ]/).includes(e._meta.state)),t}].every(e=>e())}async function fetchItems(e,t){t=new URLSearchParams(t.toString());let n=new URLSearchParams(t.toString());n.set("limit",100);let a=("coddit"==urlParams.get("meta_api")?`https://coddit.xyz/modtools/api/db/basicquery/${e}`:`https://api.pushshift.io/reddit/search/${e}/`)+(n.toString()?"?"+n.toString():"");updateRequestTable(a,"pending");try{console.log("fetching "+a+"...");const l=await fetch(a);if(updateRequestTable(a,l.status),!l.ok)throw"non-200 response status";let r=(await l.json()).data,s=[];r.forEach(t=>{t=appendItemProps(t,{type:e,fetched_from:a,request_id:qel("#request-table tbody").childElementCount,sibling_count:r.length,sibling_position:r.indexOf(t)+1,valid:!1,refreshed:!1}),s.push(t._name)});let i="https://api.reddit.com/api/info?id="+s.join(",");console.log("fetching "+i+"...");const c=await fetch(i),o=await c.json();for(let e of o.data.children){e=e.data;for(let t of r)if(e.name==t._name){for(const[n,a]of Object.entries(e))["author","selftext","body","selftext_html","body_html"].includes(n)?["selftext_html","body_html"].includes(n)?t.hasOwnProperty(n.replace(/_html$/,""))||(t[n]=a):t.hasOwnProperty(n)||(t[n]=a):t[n]=a;t._meta.refreshed=!0,array_remove(s,t._name);break}}for(let e of s)for(let t of r)if(e==t._name){t._meta.missing=!0;break}for(let e of r)e=appendExtraProps(e);newItems=r.filter(e=>!cachedItems.has(e));for(let e of newItems)e._meta.valid=validateItem(e,t),cachedItems.add(e);("none"==t.get("limit")||cachedItems.valid.length<getVisibleLimit())&&r.length==n.get("limit")&&newItems.length&&(t.has("sort")&&"asc"==t.get("sort")?t.set("after",r[r.length-1].created_utc-1):t.set("before",r[r.length-1].created_utc+1),enqueue(e,t))}catch(e){throw console.error(e),updateRequestTable(a,"failed"),gel("banner").innerHTML="Error Loading Items: "+e.message,gel("banner").classList.add("failed"),e}}function updateRequestTable(e,t){function n(n,a=t){let l=gel("request-table").querySelector("tbody"),r=!1;for(let t of Array.from(l.children))if(t.children[0].children[0].innerHTML.replace(/&amp;/g,"&")==e){t.children[1].remove(),t.insertBefore(cel("td",n,["status","status-"+a]),t.lastChild),r=!0;break}r||l.appendChild(cel("tr",[cel("td",celwa("a",[["href",e]],e)),cel("td",n,["status","status-"+a]),cel("td",l.childElementCount+1)]))}"pending"==t?n("Pending"):"failed"==t?n("Failed"):n(t,t.toString()[0])}function enqueue(e,t){requestQueue.push([e,t])}function getTitle(){let e="";if(urlParams.has("meta_type")){let t=urlParams.get("meta_type");e+="submission"==t?"Submissions ":"comment"==t?"Comments ":"Submissions and Comments "}else e+="Submissions and Comments ";if(urlParams.has("author")){e+="by "+urlParams.get("author").split(/[\s,+]/).map(e=>"u/"+e).join(" or ")+" "}if(urlParams.has("subreddit")){e+="in "+urlParams.get("subreddit").split(/[\s,+]/).map(e=>"r/"+e).join(" or ")+" "}return urlParams.has("q")&&(e+='Matching "'+urlParams.get("q")+'"'),e+" - Coddit ReSearch Results"}async function processQueue(){for(document.title="Search Results - Coddit ReSearch",gel("items-panel").classList.remove("collapsed"),gel("parameters-panel").classList.add("collapsed"),gel("banner").innerHTML='<img class="loading-icon" src="/search/static/CGH1e.png" style="height: 2em; vertical-align: middle; margin: 0 16px 2px 0;">Loading • Found <span class="loaded-count">0</span> Items',gel("banner").hidden=!1;nextRequest=requestQueue.shift();){let e=nextRequest;qel("#banner .loaded-count").innerHTML=cachedItems.valid.length,await fetchItems(e[0],e[1]),sortItems(),0==requestQueue.length&&(cachedItems.valid.length?(gel("banner").hidden=!0,!e[1].has("ids")&&cachedItems.valid.length>=getVisibleLimit()&&(gel("load-more-button").hidden=!1)):gel("banner").classList.contains("failed")||(gel("banner").innerHTML="No Data"),showItems(),updateInfo()),await sleep(1e3)}}function sortItems(){cachedItems.valid.sort((e,t)=>urlParams.has("sort")&&"asc"==urlParams.get("sort")?e.created_utc>t.created_utc?1:t.created_utc>e.created_utc?-1:0:e.created_utc<t.created_utc?1:t.created_utc<e.created_utc?-1:0)}function showItems(){let e=gel("items");for(let t=0;t<cachedItems.valid.length;t++){let n=cachedItems.valid[t];if(t>getVisibleLimit()-1)break;if(!n._meta.shown){n._meta.shown=!0;try{e.appendChild(getDisplayItem(n))}catch(e){console.error(`failed to show item ${n._name}`),console.error(e)}gel("item-count").innerHTML=e.childElementCount}}}function updateInfo(){let e=gel("info");e.innerHTML="";let t=[],n=[],a=0,l=0;for(let e of cachedItems.shown){let r=t.find(t=>t.name==e.subreddit);r||(r={name:e.subreddit,contributions:0,submissions:0,comments:0},t.push(r));let s=n.find(t=>t.name==e.author);s?s.count+=1:(s={name:e.author,contributions:0,submissions:0,comments:0},n.push(s)),r.contributions+=1,s.contributions+=1,"submission"==e._type?(r.submissions+=1,s.submissions+=1,a+=1):(r.comments+=1,s.comments+=1,l+=1)}function r(e,t,n,a){return celp("a",t,{href:"javascript:void(0);",onclick(t){function l(){return Array.from(e.children).filter(e=>!e.classList.contains(n)).length}let r=t.target.parentElement.parentElement;if(t.ctrlKey||t.shiftKey)r.classList.contains(n)?r.classList.remove(n):r.classList.add(n);else if(r.classList.contains(n)||1!=l()){for(let t of e.children)t.classList.add(n);r.classList.remove(n)}else for(let t of e.children)t.classList.remove(n);if(0==l())for(let t of e.children)t.classList.remove(n);for(let t of gel("items").children){t.classList.add(n);for(let l of e.children)l.classList.contains(n)||t.dataset[a]!=l.querySelector("td:first-of-type a").innerHTML||t.classList.remove(n)}}})}t.sort((e,t)=>e.contributions<t.contributions?1:t.contributions<e.contributions?-1:0),n.sort((e,t)=>e.contributions<t.contributions?1:t.contributions<e.contributions?-1:0),Array.from(gel("items").children).forEach(e=>{e.classList.remove("user-hidden-subreddit"),e.classList.remove("user-hidden-author")}),e.appendChild(cel("div",cel("table",[cel("caption","General"),cel("thead",cel("tr",[cel("th","Total Items"),cel("th","Submissions"),cel("th","Comments")])),cel("tbody",[cel("tr",[cel("td",cachedItems.shown.length,"center"),cel("td",a,"center"),cel("td",l,"center")])])]))),e.appendChild(cel("table",[cel("caption","Subreddits • "+t.length),cel("thead",[cel("tr",[cel("th","Subreddit"),cel("th","Total"),cel("th","Subs"),cel("th","Coms")])]),function(){let e=cel("tbody");for(let n of t)if(e.appendChild(cel("tr",[cel("td",r(e,n.name,"user-hidden-subreddit","subreddit")),cel("td",n.contributions,"center"),cel("td",n.submissions,"center"),cel("td",n.comments,"center")])),e.childElementCount>24){e.appendChild(cel("tr",[cel("td","<a>...</a>"),cel("td","<a>...</a>","center"),cel("td","<a>...</a>","center"),cel("td","<a>...</a>","center")]));break}return e}()])),e.appendChild(cel("table",[cel("caption","Authors • "+n.length),cel("thead",[cel("tr",[cel("th","Author"),cel("th","Total"),cel("th","Subs"),cel("th","Coms")])]),function(){let e=cel("tbody");for(let t of n)if(e.appendChild(cel("tr",[cel("td",r(e,t.name,"user-hidden-author","author")),cel("td",t.contributions,"center"),cel("td",t.submissions,"center"),cel("td",t.comments,"center")])),e.childElementCount>24){e.appendChild(cel("tr",[cel("td","<a>...</a>"),cel("td","<a>...</a>","center"),cel("td","<a>...</a>","center"),cel("td","<a>...</a>","center")]));break}return e}()])),gel("info-panel").classList.remove("collapsed")}for(let[e,t]of Object.entries(getCookies()))e.startsWith("setting_")&&(t.match(/^(true|false)$/)?t="true"==t:(parseInt(t)||0==t)&&(t=parseInt(t)),settings[e.replace(/^setting_/,"")]=t);if(settings.advanced?document.body.classList.add("setting-advanced"):(gels("advanced-option").forEach(e=>{e.hidden=!0}),qels(".advanced-option input, .advanced-option select").forEach(e=>{e.disabled=!0})),settings.dev&&document.body.classList.add("setting-dev"),gel("parameter-meta_type").onchange=(e=>{gels("comments-only").forEach(e=>e.disabled=!1),gels("submissions-only").forEach(e=>e.disabled=!1),"submission"==e.target.value?gels("comments-only").forEach(e=>e.disabled=!0):"comment"==e.target.value&&gels("submissions-only").forEach(e=>e.disabled=!0)}),gel("parameter-meta_api").onchange=(e=>{"coddit"==e.target.value&&alert("NOTICE: The coddit statistics API is not a Pushshift equivalent.\n\nIts primary purpose is to provide subreddit analytics and moderation utilities for r/teenagers. It only contains data from a few select subreddits and does not support full text search or many of the other parameters available with Pushshift.")}),gel("request-form").onsubmit=(e=>{Array.from(e.target.querySelectorAll("input, select")).forEach(t=>{if(t.value&&t.value!=t.dataset.defaultValue||(t.name=""),t.name.match(/\[\]$/)){t.name=t.name.substring(0,t.name.length-2);for(const n of t.value.split(/;/g))e.target.appendChild(celfs(`<input type="hidden" name="${t.name}" value="${n}">`));t.name="",t.disabled=!0}})}),qels("input[type='checkbox']").forEach(e=>{e.value=e.checked,e.addEventListener("change",()=>{e.value=e.checked})}),qels("select").forEach(e=>{let t=e.parentElement;if(t.classList.contains("select")){new MutationObserver(function(n,a){n.forEach(n=>{"disabled"==n.attributeName&&(e.disabled?t.classList.add("disabled"):t.classList.remove("disabled"))})}).observe(e,{attributes:!0})}}),qels(".panel-header").forEach(e=>{e.onclick=(()=>{let t=e.parentElement;t.classList.contains("collapsed")?t.classList.remove("collapsed"):t.classList.add("collapsed")})}),qels(".panel").forEach(e=>{e.addEventListener("click",e=>{e.target.classList.contains("collapsed")&&e.target.classList.remove("collapsed")})}),gel("download-button").onclick=(()=>{downloadText(JSON.stringify({items:cachedItems.valid},null,4),"data.json")}),window.location.href.split("?").length>1){let e=new URLSearchParams(window.location.search),t="any";e.has("meta_type")&&(t=e.get("meta_type")),qels("#request-form input, #request-form select").forEach(t=>{let n=t.id.replace(/^parameter-/,"");if(e.has(n))if(t.name.match(/\[\]$/)){t.value="";for(const[n,a]of e.entries())n==t.id.replace(/^parameter-/,"")&&(t.value+=a+";");t.value=t.value.substring(0,t.value.length-1)}else"checkbox"==t.type?t.checked="true"==e.get(n):t.value=e.get(n)}),["before","after"].forEach(t=>{e.has(t)&&e.get(t).match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}$/)&&e.set(t,Date.parse(e.get(t))/1e3)});let n=new URLSearchParams([...e.entries()].filter(e=>e[1]&&!e[0].startsWith("meta_")).reduce((e,t)=>e+t[0]+"="+encodeURIComponent(t[1])+"&","?"));if(n.has("q"))for(let e of n.get("q").split("|"))queryTermParams=new URLSearchParams(n.toString()),queryTermParams.set("q",e),"any"==t?(enqueue("submission",queryTermParams),enqueue("comment",queryTermParams)):enqueue(t,queryTermParams);else"any"==t?(enqueue("submission",n),enqueue("comment",n)):enqueue(t,n);processQueue(),gel("load-more-button").innerHTML="Load "+("asc"==n.get("sort")?"After":"Before"),gel("load-more-button").onclick=(e=>{e.target.hidden=!0,e.target.dataset.pageCount=parseInt(e.target.dataset.pageCount)+1;let a=cachedItems.valid[cachedItems.valid.length-1];if(cachedItems.valid.length<getVisibleLimit()*("any"==t?2:1)){if("asc"==n.get("sort")?(n.set("after",a.created_utc-1),n.delete("before")):(n.set("before",a.created_utc+1),n.delete("after")),n.has("q"))for(let e of n.get("q").split("|"))queryTermParams=new URLSearchParams(n.toString()),queryTermParams.set("q",e),"any"==t?(enqueue("submission",queryTermParams),enqueue("comment",queryTermParams)):enqueue(t,queryTermParams);else"any"==t?(enqueue("submission",n),enqueue("comment",n)):enqueue(t,n);processQueue()}else showItems(),updateInfo(),!urlParams.has("ids")&&cachedItems.valid.length>=getVisibleLimit()&&(gel("load-more-button").hidden=!1)})}qels("[data-dependent-on]").forEach(e=>{let t=e.dataset.dependentOn.split(/=/),n=gel(t[0]),a=t.slice(1).join("");function l(){e.disabled=a?!n.value.match(a):!n.value}if(l(),"SELECT"==n.tagName)n.addEventListener("change",()=>{l()});else if("INPUT"==n.tagName)switch(n.type){case"checkbox":n.addEventListener("change",()=>{l()});break;case"text":case"search":case"password":n.addEventListener("keyup",()=>{l()})}});</script> </body> </html> 